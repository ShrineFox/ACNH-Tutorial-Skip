flow Cmn_ChoiceA():
    run Event11()
 
flow Cmn_ChoiceB():
    run Event12()
 
flow Root():
    if System.EventFlags['cPlayer:MuseumCafeEv_3_ConfirmedVisitingTown']:
        # RANDOM: I'll be seeing you on your island soon… // Well then, be seeing you… // Give Blathers my best…
        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:031', false)
    elif System.EventFlags['cPlayer:MuseumCafeEv_2_TalkedWithMasterAtIsland']:
        # Coo… You need something?
        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:002', false)
        switch EventFlowSystemActor.GeneralTalkChoice3EventFlowSystemActor.GeneralTalkChoice3():
            case 0:
                run Cmn_ChoiceA()
            case 1:
                run Cmn_ChoiceB()
            case 2:
                # Is that so? Very well…
                MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:012', false)
    else:
        System.EventFlags['cPlayer:MuseumCafeEv_2_TalkedWithMasterAtIsland'] = true
        # Coo… You out here looking for gyroids too?
        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:001', false)
        switch EventFlowSystemActor.GeneralTalkChoice3EventFlowSystemActor.GeneralTalkChoice3():
            case 0:
                # I hope you find a gyroid…
                MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:011', false)
            case 1:
entrypoint Event11:
                # …Do I know a who? Coo… You're looking at him…
                MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:021_01', false)
                run Sub_Event15()
            case 2:
entrypoint Event12:
                # You're looking for me?
                MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:021_02', false)
                run Sub_Event15()
 
local flow Sub_Event15():
    # Mind if I ask what you're after?
    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:022', true)
    switch EventFlowSystemActor.GeneralTalkChoice2EventFlowSystemActor.GeneralTalkChoice2():
        case 0, 1:
            # I see… I hear you. …Tell him that for me.
            MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:023', false)
            # Oh, and also…
            MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:024', false)
            if EventFlowSystemActor.SystemHasBaggageSpaceEventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1:
                # If you find a <item>gyroid fragment on this island, you should take it home with you… If you plant it in the ground and water it, it will grow up str…
                MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:025_02', false)
            else:
                MainNpc.SetDeliveryItemAtRandomMainNpc.SetDeliveryItemAtRandom(14546, true, 'cVillageRemakePattern', 0)
                MainNpc.SetItemNameMainNpc.SetItemName(14, 0, 0)
                MainNpc.NpcDeliveryMainNpc.NpcDelivery(1, 'Keep')
                # This is yours if you want it… It's [a|an]<125:0:0000>… Plant it in the ground. Give it some water and some time. It will grow up strong the next day……
                MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:025_01', true)
                MainNpc.NpcDeliveryMainNpc.NpcDelivery(2, 'Default')
            # Well then, be seeing you…
            MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/pge/SP_pge_03_TourIsland:026', false)
            System.EventFlags['cPlayer:MuseumCafeEv_3_ConfirmedVisitingTown'] = true
 
