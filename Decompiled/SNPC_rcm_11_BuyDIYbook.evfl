flow Branch_ChkHarvestRecipe():
	if EventFlowSystemActor.MultiItemSelectInclude(5605, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
		if EventFlowSystemActor.PlayerHasCraftRecipe('DIYbook3', 65534):
			run RcmDIYbookBought()
		else:
			run RcmDIYbookBuySel()
			EventFlowSystemActor.PlayerSetCraftRecipe('DIYbook3', 65534)
			run Event28()
	elif EventFlowSystemActor.MultiItemSelectInclude(13787, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
		if EventFlowSystemActor.PlayerHasCraftRecipe('HarvestFtr', 65534):
			# Not that we're keeping track, but… you've already learned all of the DIY recipes in that collection! Perhaps you would enjoy the challenge of craftin…
			MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:2003', false)
			run SNPC_rcm_00_Common::BuyCancelNoAsk()
		else:
			run RcmDIYbookBuySel()
			EventFlowSystemActor.PlayerSetCraftRecipe('HarvestFtr', 65534)
entrypoint Event28:
			# And we're done!<10:4> I hope you enjoy DIY even more now with your new recipes!__ ...new recipes!__
			MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:107_02', false)
			run Event50()

flow Branch_WhatIsHarvestRecipe():
	if EventFlowSystemActor.MultiItemSelectInclude(5605, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
		# This <125:0:0000> contains a mix of recipes that require a mastery of various materials!
		MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:106_01_03', false)
		run Event71()
		return
	elif EventFlowSystemActor.MultiItemSelectInclude(13787, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
		# Ah! You've found a collection of DIY recipes inspired by Turkey Day. It's <50:1><125:0:0000>! We'll only be offering this collection until the end of…
		MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:2004', false)
		run Event71()
		return
	elif EventFlowSystemActor.MultiItemSelectInclude(14811, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
		# Ah, <125:0:0000>? That's a simple cookbook filled with recipes using basic ingredients.
		MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:4011', false)
		# I'll send the recipe data to your app immediately if you decide to make a purchase.
		MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:4019', false)
		run RcmDIYbookBuySel()
	elif EventFlowSystemActor.MultiItemSelectInclude(14816, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
		# Ah, <125:0:0000>? That's a cookbook filled with recipes from our recent Turkey Day celebration!
		MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:4012', false)
		# I'll send the recipe data to your app immediately if you decide to make a purchase.
		MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:4019', false)
		run RcmDIYbookBuySel()
	else:
		return

flow ChkCookingOrDIY():
	SubflowResults[14] = 0
	if (EventFlowSystemActor.MultiItemSelectInclude(14811, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect')) or (EventFlowSystemActor.MultiItemSelectInclude(14816, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect')):
		run CookingRecipeBook()
		EventFlowSystemActor.ExitFlowchart()

flow CookingRecipeBook():
	SubflowResults[14] = 1
	# This is a digital book filled with food and drink recipes!__ ...recipes!__ And it's called… <125:0:0000>!
	MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:4001', false)
	if not System.EventFlags['cPlayer:MainmenuRecipe_v2']:
		if EventFlowSystemActor.IsMyVillage():
			# Sorry, but we can't sell you food or drink recipes until you have the DIY Recipes+ app upgrade. To get the app upgrade, you have to redeem Nook Miles…
			MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:4021', false)
		else:
			# Sorry, but we can only sell food and drink recipes to folks that have the DIY Recipes+ app upgrade. If you want the upgrade, you'll need to visit the…
			MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:4022', false)
		run SNPC_rcm_00_Common::BuyCancelNoAsk()
	elif EventFlowSystemActor.MultiItemSelectInclude(14811, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
		if EventFlowSystemActor.PlayerHasCookingRecipe('DishShopRecipeBook', 65534):
			run RcmDIYbookBought()
		else:
			run RcmDIYbookBuySel()
			EventFlowSystemActor.PlayerSetCookingRecipe('DishShopRecipeBook', 65534)
			run Sub_Event113()
	elif EventFlowSystemActor.MultiItemSelectInclude(14816, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
		if EventFlowSystemActor.PlayerHasCookingRecipe('DishHarvestRecipeBook', 65534):
			# I think you've already learned all the recipes in that cookbook. If you haven't tried making them all yet, you should. Turkey Day food is always so d…
			MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:4020', false)
			run SNPC_rcm_00_Common::BuyCancelNoAsk()
		else:
			run RcmDIYbookBuySel()
			EventFlowSystemActor.PlayerSetCookingRecipe('DishHarvestRecipeBook', 65534)
			run Sub_Event113()

flow RcmDIYbookBought():
	# I do believe you've purchased this already, PLAYER!
	MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:104_02', false)
	run SNPC_rcm_00_Common::BuyCancelNoAsk()

flow RcmDIYbookBuySel():
	# Let's see… That's <90:24:0000>. What do you think?
	MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:104', false)
	switch EventFlowSystemActor.GeneralTalkChoice3():
		case 0:
			run SNPC_rcm_00_Common::Rcm_Common_BuyCheckUI()
			System.EventFlags['cPlayerTemp:RcmBoughtGrocery'] = true
			EventFlowSystemActor.UIShopBuyDisappear()
			if (not EventFlowSystemActor.NetIsConnected()) and (EventFlowSystemActor.ShopLevel() != `InResServiceTent`):
				MainNpc.NpcMoveToPlayer()
			Player.PlayerChangeStateDemoTalk()
			Player.TurnBody(0, 0.0)
			Player.PlayerWaitTurn()
			MainNpc.SmartPhone(0)
			if SubflowResults@2[14] == 0:
				# OK, time to send the recipes from "<125:0:0000>" to your phone…
				MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:107_01', true)
			else:
				# OK, time to send the recipes from "<125:0:0000>" to your phone…
				MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:4002', true)
			EventFlowSystemActor.WaitFrame(15)
			Player.SmartPhone(0)
			fork:
				branch:
					Player.SmartPhone(4)
				branch:
					MainNpc.CharacterEmoticonAction('Smiling', true, '', 30, false)
			EventFlowSystemActor.WaitFrame(20)
			MainNpc.CharacterEmoticonAction('EmotEnd', true, '', 30, false)
			MainNpc.SmartPhone(4)
			EventFlowSystemActor.WaitFrame(30)
			MainNpc.SmartPhoneSE(2, 'Phone_Sending')
			EventFlowSystemActor.WaitFrame(30)
			Player.SmartPhoneSE(2, 'Phone_Recieving')
			EventFlowSystemActor.WaitFrame(15)
			MainNpc.SmartPhone(5)
			Player.SmartPhone(5)
		case 1:
			if EventFlowSystemActor.MultiItemSelectInclude(5603, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
				# This <125:0:0000> contains simple DIY recipes that use materials you can easily obtain.
				MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:106_01_01', false)
entrypoint Event71:
				# I'll send the recipe data to your app immediately if you decide to make a purchase.
				MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:106_02', false)
				run RcmDIYbookBuySel()
			elif EventFlowSystemActor.MultiItemSelectInclude(5604, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
				# This <125:0:0000> contains recipes that require an interesting variety of materials.
				MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:106_01_02', false)
entrypoint Event71:
				# I'll send the recipe data to your app immediately if you decide to make a purchase.
				MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:106_02', false)
				run RcmDIYbookBuySel()
			else:
				run Branch_WhatIsHarvestRecipe()
		case 2:
			run SNPC_rcm_00_Common::Rcm_Groceries_Buy_Cancel()

flow Rcm_Cmn_DisableDIY():
	if EventFlowSystemActor.IsMyVillage():
		# You haven't attempted a DIY project here on the island yet, correct?
		MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:104_01_01', false)
		if EventFlowSystemActor.ShopLevel() == `InResServiceTent`:
			# Right now, the boss is offering a free DIY workshop, so please give that a try first!
			MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:104_01_02', false)
		else:
			# Right now, the boss is offering a free DIY workshop inside Resident Services, so please try that first!
			MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:104_01_03', false)
	else:
		# Oh! I'm afraid we can only sell that to customers who have the DIY app. If you'd like to learn more about DIY, you should stop by Resident Services o…
		MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:108', false)

flow Root():
	run ChkCookingOrDIY()
	# "<50:3><125:0:0000>" is a digital DIY recipe book!__ ...book!__
	MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:105_01', false)
	if not System.EventFlags['cPlayer:MainmenuRecipe']:
		run Rcm_Cmn_DisableDIY()
		run SNPC_rcm_00_Common::BuyCancelNoAsk()
	elif EventFlowSystemActor.MultiItemSelectInclude(5603, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
		if EventFlowSystemActor.PlayerHasCraftRecipe('DIYbook1', 65534):
			run RcmDIYbookBought()
		else:
			run RcmDIYbookBuySel()
			EventFlowSystemActor.PlayerSetCraftRecipe('DIYbook1', 65534)
			run Event28()
	elif not EventFlowSystemActor.MultiItemSelectInclude(5604, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 'cItemSelect'):
		run Branch_ChkHarvestRecipe()
	elif EventFlowSystemActor.PlayerHasCraftRecipe('DIYbook2', 65534):
		run RcmDIYbookBought()
	else:
		run RcmDIYbookBuySel()
		EventFlowSystemActor.PlayerSetCraftRecipe('DIYbook2', 65534)
		run Event28()

local flow Sub_Event113():
	# We're done!<10:4> We hope you enjoy making food and drinks even more with all those new recipes!__ ...recipes!__
	MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:4003', false)
entrypoint Event50:
	fork:
		branch:
			MainNpc.SmartPhone(1)
		branch:
			EventFlowSystemActor.WaitFrame(15)
			Player.SmartPhone(1)
	System.EventFlags['cPlayerTemp:RcmBoughtGrocery'] = true
	# Anything else look interesting?
	MainNpc.OpenMessageWindow('TalkSNpc/rcm/SP_rcm_00_common:092', false)
	if EventFlowSystemActor.ShopLevel() != `InResServiceTent`:
		Player.TurnBody(13, 0.0)
		Player.PlayerWaitTurn()
	run SNPC_rcm_00_Common::Rcm_Common_BuyAgain2()
