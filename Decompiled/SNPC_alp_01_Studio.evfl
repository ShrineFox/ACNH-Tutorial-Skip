flow Alp_Chk_Exchange():
    if not System.EventFlags['cPlayer:AlwJuneBrideQuestClearFlag']:
        run SNPC_alw_01_Studio::Alw_DayChkrun SNPC_alw_01_Studio::Alw_DayChk()
        switch SubflowResults@8[0]:
            case 0:
                if EventFlowSystemActor.RandomChoiceExcludePrevious2EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
                    # We're countin' on ya, squirt!
                    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:101', false)
                else:
                    # I made a whole mess of special furniture just for this shoot. Don't be shy about usin' it!
                    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:102', false)
                EventFlowSystemActor.ExitFlowchartEventFlowSystemActor.ExitFlowchart()
            case 5:
                if System.EventFlags['cPlayer:AlwJuneBrideQuestStartFlag']:
                    if EventFlowSystemActor.RandomChoiceExcludePrevious2EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
                        # What's a wedding without a big ol' reception to cap it off? I can't wait to see all the photos.
                        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:103', false)
                    else:
                        # Reese sure is a sight, eh? All eyes are gonna be on her at this reception shoot. Everyone had better be respectful. She's married to ME!
                        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:104', false)
                    System.EventFlags['cPlayer:AlpJuneBrideExchangeFlag'] = true
            default:
                return
 
flow Alp_Chk_GetStick():
    switch SubflowResults@8[0]:
        case 6:
            if not System.EventFlags['cPlayer:AlwJuneBrideQuestClearFlag']:
                run Sub_grp_Event50()
        case 7:
            run Sub_grp_Event50()
        default:
            return
 
flow Alp_Exchange():
    if EventFlowSystemActor.GeneralTalkChoice2EventFlowSystemActor.GeneralTalkChoice2() == 0:
        # Alright! What's grabbin' ya?
        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:003', false)
entrypoint Event39:
        EventFlowSystemActor.UICatalogGiftHandlingEventFlowSystemActor.UICatalogGiftHandling()
        if EventFlowSystemActor.UIResultMenuDecideEventFlowSystemActor.UIResultMenuDecide():
            MainNpc.SetItemNameMainNpc.SetItemName(35, 0, 0)
            EventFlowSystemActor.SetTagFromUIResultEventFlowSystemActor.SetTagFromUIResult('cExchangeRequireNum', 0)
            # OK, how about…<90:2:0000> <item>heart crystals for my <125:0:0000>?
            MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:010', false)
            if EventFlowSystemActor.GeneralTalkChoice2EventFlowSystemActor.GeneralTalkChoice2() == 0:
                if MainNpc.NpcIsSittingMainNpc.NpcIsSitting() in (0, 1, 2, 3, 5):
                    # Great! I'll take those <item>heart crystals…
                    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:013_02', true)
                else:
                    # Great! I'll take those <item>heart crystals…
                    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:013', true)
                    MainNpc.SetDeliveryItemAtRandomMainNpc.SetDeliveryItemAtRandom(12546, false, 'cVillageRemakePattern', 0)
                    MainNpc.NpcDeliveryMainNpc.NpcDelivery(0, 'Default')
                    # Hate seein' this stuff go, but a deal's a deal. I'll get everything on its way, so keep an eye out. Oh! And thanks.
                    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:014', false)
                EventFlowSystemActor.DeleteRequireExchangeItemEventFlowSystemActor.DeleteRequireExchangeItem()
                EventFlowSystemActor.CommuneMailSendEventFlowSystemActor.CommuneMailSend('cAlw_Alp', 'MAIL_SNpc_alw_JuneBride', 3, 'cCatalogGift', 'cFastTomorrow', 'cFromUICatalogGift')
                System.EventFlags['cPlayer:AlpJuneBrideExchangeFlag'] = true
                if EventFlowSystemActor.HasTargetItemEventFlowSystemActor.HasTargetItem(12546, 3):
                    if EventFlowSystemActor.HasFreeInCommuneMailEventFlowSystemActor.HasFreeInCommuneMail():
                        # Y'know, if you wanna get rid of a few more <item>heart crystals, there's still furniture in it for ya.
                        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:015', false)
                        run Alp_Exchange()
                    else:
                        # Y'know, you're doing an awful lot of tradin' today.
                        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:016', false)
                        # I oughta get caught up on that other stuff you wanted.<10:4> How 'bout we hold off on more trades till later?
                        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:017', false)
                return
            else:
                # It's no fleece off my hide, squirt. You're doin' me a favor, so take all the time ya need.
                MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:011', false)
                if EventFlowSystemActor.GeneralTalkChoice2EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    run Event39()
                else:
                    # Suit yourself. But think on it.
                    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:004', false)
                    return
        else:
            # Huh? I thought we had a deal. You'd better be comin' back.
            MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:005', false)
            return
    else:
        # Suit yourself. But think on it.
        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:004', false)
        return
 
flow Root():
    run SNPC_alw_01_Studio::Alw_DayChkrun SNPC_alw_01_Studio::Alw_DayChk()
    run Alp_Chk_GetStick()
    run Alp_Chk_Exchange()
    if not EventFlowSystemActor.HasFreeInCommuneMailEventFlowSystemActor.HasFreeInCommuneMail():
        # I oughta get caught up on that other stuff you wanted.<10:4> How 'bout we hold off on more trades till later?
        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:017', false)
    elif System.EventFlags['cPlayer:AlpJuneBrideExchangeFlag']:
        # Heya, squirt. I'll trade some more furniture for your <item>heart crystals. Whaddaya say?
        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:002', false)
        run Alp_Exchange()
    else:
        # Howdy, squirt. Any interest in tradin' those <item>heart crystals for some of my furniture? Reese thinks they're pretty.
        MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:001', false)
        run Alp_Exchange()
 
flow Root_Init():
    if (EventFlowSystemActor.TermEventNowEventFlowSystemActor.TermEventNow('JuneBride', false)) and (System.EventFlags['cPlayer:CommuneIslandAvailable']):
        MainNpc.NpcAITalkSubCastEntryMainNpc.NpcAITalkSubCastEntry('alw', 1)
 
local flow Sub_Event57():
    System.EventFlags['cPlayer:AlpJuneBrideGetStickFrag'] = true
    EventFlowSystemActor.ExitFlowchartEventFlowSystemActor.ExitFlowchart()
 
local flow Sub_Event64():
    if MainNpc.NpcIsSittingMainNpc.NpcIsSitting() in (0, 1, 2, 3, 5):
        MainNpc.SetEventRewardToPlayerBaggageMainNpc.SetEventRewardToPlayerBaggage('cFree')
        if EventFlowSystemActor.PlayerHasCraftRecipeEventFlowSystemActor.PlayerHasCraftRecipe('', 12695):
            # Actually, if you check your pockets, you'll see I already snuck 'em in there. Anyhoo, enjoy!
            MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:023_01', false)
            run Sub_Event57()
        else:
            # I went ahead and stuck it in your pockets. Hope you don't mind. Be sure to think of us when you're makin' it, ya hear?
            MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:023', false)
            run Sub_Event57()
    else:
        MainNpc.SetDeliveryItemMainNpc.SetDeliveryItem(1, true)
        EventFlowSystemActor.MessageSuspendEventFlowSystemActor.MessageSuspend()
        MainNpc.NpcDeliveryMainNpc.NpcDelivery(1, 'Default')
        if EventFlowSystemActor.PlayerHasCraftRecipeEventFlowSystemActor.PlayerHasCraftRecipe('', 12695):
            # By the by, I'd be happy to take those back from you if any of this wedding stuff catches your eye, squirt. Come on back if you feel like tradin'! Or …
            MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:021_01', false)
            run Sub_Event57()
        else:
            # Be sure to think of us when you're makin' it, ya hear?
            MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:021', false)
            run Sub_Event57()
 
local flow Sub_grp_Event50():
    if not System.EventFlags['cPlayer:AlpJuneBrideGetStickFrag']:
        if System.EventFlags['cPlayer:AlpJuneBrideNotGetLoveCrystalFrag']:
            EventFlowSystemActor.SelectRewardItemDirectEventFlowSystemActor.SelectRewardItemDirect(12546, 10, 'cVillageRemakePattern', 0)
            if EventFlowSystemActor.ShoppingCapacityEventFlowSystemActor.ShoppingCapacity('cReward', 65534):
                # I see you made some room in those pockets. Here's 10 <item>heart crystals, as promised!
                MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:022_02', false)
                run Sub_Event64()
        else:
            if EventFlowSystemActor.PlayerHasCraftRecipeEventFlowSystemActor.PlayerHasCraftRecipe('', 12695):
                # You've done a lot for us, squirt. We really appreciate it. I know it ain't much, but we both feel you've earned something for helpin' us out. So here…
                MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:020_01', false)
                EventFlowSystemActor.SelectRewardItemDirectEventFlowSystemActor.SelectRewardItemDirect(12546, 10, 'cVillageRemakePattern', 0)
            else:
                # You've done a lot for us, squirt. We really appreciate it. Here, this is somethin' the two of us worked on. It's a DIY recipe for a <item>wedding wan…
                MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:020', false)
                EventFlowSystemActor.NpcSetRewardRecipeEventFlowSystemActor.NpcSetRewardRecipe(12695, false)
                if not System.EventFlags['cPlayer:MainmenuRecipe']:
                    # Just a sec. You do know your way around DIY, don'tcha? So, basically, DIY is makin' tools and furniture and such, and it's pretty fun once you get a …
                    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:024', false)
            if EventFlowSystemActor.ShoppingCapacityEventFlowSystemActor.ShoppingCapacity('cReward', 65534):
                run Sub_Event64()
            else:
                if EventFlowSystemActor.PlayerHasCraftRecipeEventFlowSystemActor.PlayerHasCraftRecipe('', 12695):
                    # Hm! Well, I can't give 'em to you on account of your pockets bein' full.<10:4> Go clear some space and come back!
                    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:022_01', false)
                    System.EventFlags['cPlayer:AlpJuneBrideNotGetLoveCrystalFrag'] = true
                    EventFlowSystemActor.ExitFlowchartEventFlowSystemActor.ExitFlowchart()
                else:
                    # Hm! I don't think I can give it to you on account of your pockets bein' full.<10:4> Not to worry. I'll just mail it to ya!
                    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:022', false)
                    # Be sure to think of us when you're makin' it, ya hear?
                    MainNpc.OpenMessageWindowMainNpc.OpenMessageWindow('TalkSNpc/alp/GEvent/SP_alp_GEvent_JuneBride:021', false)
                    EventFlowSystemActor.SystemMailSendEventFlowSystemActor.SystemMailSend('cAlw_Alp', 'MAIL_SNpc_alw_JuneBride', 4, 'cNone', 'cFastTomorrow', 'cReward', false, false)
                    run Sub_Event57()
 
