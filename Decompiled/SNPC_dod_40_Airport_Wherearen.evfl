flow DepartureWherearen():
    EventFlowSystemActor.MiniGameSilentCancel()
    if System.EventFlags['cPlayer:EquipLicenseHelmet']:
        run SNPC_dod_AirPort::LandMakingRemove_Soloplayrun SNPC_dod_AirPort::LandMakingRemove_Soloplay()
    # <10:12><100:3:cd01>Dodo One, this is Dodo Tower—Wilbur, you copy? Got a walker who needs wings, over. Roger! Ready when you are!<100:3:cd02><10:8:002…
    MainNpc.OpenMessageWindow('TalkSNpc/dod/SP_dod_AirPort:037_01', true)
    run Dod_GoToWherearen()
 
flow Dod_GoToWherearen():
    Player.PlayerChangeDemoState('cReserveNextSceneStartToolOff')
    System.EventFlags['cPlayer:DodSingleFlightToday'] = true
    EventFlowSystemActor.BGMPropertyControl(143)
    EventFlowSystemActor.SoundTriggerEmit('Airplane_Takeoff_Short', -1)
    EventFlowSystemActor.BGMPropertyControl(159)
    EventFlowSystemActor.StartMeasurePlayTime('cWherearenIslands')
    if System.EventFlags['cPlayer:WHEREAREN_VisitDone']:
        EventFlowSystemActor.CameraReserveFirstStateCommand('Talk:doc', '', false)
        EventFlowSystemActor.SystemRequestChangeStage('cWherearenGrowUp', 'cDALWherearenWithLoadWait', 'cCircle', 'cBlack', 1.0, 1.0)
    else:
        System.EventFlags['cPlayer:WHEREAREN_VisitDone'] = true
        EventFlowSystemActor.SoundSceneChangeFadeOutDucking(8)
        EventFlowSystemActor.ReserveSystemFlowDemo('Demo_Wherearen_Op', 'OpDemo_Introduction', false, false, false)
        EventFlowSystemActor.SystemRequestChangeStage('cWherearenOpeningMessage', 'cDALWherearenWithLoadWait', 'cCircle', 'cBlack', 1.0, 1.0)
 
flow GoToWherearen():
    if EventFlowSystemActor.IsWherearenAocAvailable():
        # Ah, so you're going to work! Roger that!
        MainNpc.OpenMessageWindow('TalkSNpc/dod/SP_dod_AirPort:1001', false)
        # I can set you up right now, but are you ready? All packed and stuff?
        MainNpc.OpenMessageWindow('TalkSNpc/dod/SP_dod_AirPort:1002', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            # «Alright!» Let's get you airborne.<10:8:003c0000> 
            MainNpc.OpenMessageWindow('TalkSNpc/dod/SP_dod_AirPort:037', true)
            if EventFlowSystemActor.SaveHasWherearenIslands():
                run DepartureWherearen()
            elif EventFlowSystemActor.SaveExtensionCheck('cWherearenIslands'):
                # Expanding save data for the downloadable content.
                EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_WherearenMsg:4003', false)
                EventFlowSystemActor.WaitFrame(30)
                EventFlowSystemActor.SaveExtend('cWherearenIslands')
                EventFlowSystemActor.MessageSuspend()
                if EventFlowSystemActor.SaveExtensionIsSuccess():
                    run DepartureWherearen()
                else:
                    EventFlowSystemActor.ExitFlowchartEventFlowSystemActor.ExitFlowchart()
            else:
                run DepartureWherearen()
        else:
            # Ah, gotcha. Well, hope to see you flying with us another time. Toodles!
            MainNpc.OpenMessageWindow('TalkSNpc/dod/SP_dod_AirPort:903', false)
            EventFlowSystemActor.ExitFlowchartEventFlowSystemActor.ExitFlowchart()
    else:
        run NoAoC()
 
flow NoAoC():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.UIVersionGuideAppear('cNormal', 'cOn')
    # To play the content past this point, you must have the paid downloadable content for this software, Animal Crossing: New Horizons – Happy Home Paradi…
    EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_WherearenMsg:4000', true)
    EventFlowSystemActor.UIVersionGuideDisappear('cNormal')
    EventFlowSystemActor.ExitFlowchartEventFlowSystemActor.ExitFlowchart()
 
