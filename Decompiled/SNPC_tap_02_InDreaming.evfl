flow InDreamTalk():
    # Do you require guidance?
    MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:2001', false)
entrypoint Event35:
    switch EventFlowSystemActor.GeneralTalkChoice4():
        case 0:
            # To leave the dream, you may simply lie down in this bed, or you can press the  Button anywhere in the dream. When you wake, your belongings shall be…
            MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:2012', false)
            run Return_InDreamTalk()
        case 1:
            # Dream islands are unchanging. Nothing you do can affect the real island, so you may do as you wish. You must also enter each dream empty-handed, but …
            MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:2021', false)
            run Return_InDreamTalk()
        case 2:
            # It is possible that you may come across inappropriate content while in a dream. Should this occur, please press the  Button to report that dream. On…
            MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:2031', false)
            run Return_InDreamTalk()
        case 3:
            # Understood. Have a pleasant dream.
            MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:2041', false)
 
flow Jumpup():
    EventFlowSystemActor.MiniGameSilentCancel()
    EventFlowSystemActor.StopMeasurePlayTime('cDreaming')
    EventFlowSystemActor.NetExitDream(false)
    EventFlowSystemActor.BGMPropertyControl(103)
    EventFlowSystemActor.SoundDuckingOn(42)
    EventFlowSystemActor.SoundTriggerEmit('WipeDreamingToHome', -1)
    EventFlowSystemActor.NextLPFadeTime(3.5)
    EventFlowSystemActor.SoundSceneChangeFadeOutDucking(0)
    EventFlowSystemActor.SystemRequestChangeStage('cDreamDemo', 'cDream', 'cDream', 'cBlack', 1.0, 1.0)
 
flow Return_InDreamTalk():
    # Is there any other information you require?
    MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:2002', false)
    run Event35()
 
flow Root():
    EventFlowSystemActor.BGMPropertyControl(105)
    EventFlowSystemActor.CameraSetDemoParam('InDreamZoomIn', '', 'Player', false, false, true, 0)
    EventFlowSystemActor.CameraSetDemoParam('InDreamZoomOut', 'InDreamZoomInOut', 'Player', false, false, true, 0)
    EventFlowSystemActor.WaitFrame(150)
    EventFlowSystemActor.WaitFrame(30)
    # Now, open your eyes…
    MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:001', true)
    EventFlowSystemActor.WaitFrame(10)
    Player.PlayerStartAnimeBedWaitOpenEyes()
    EventFlowSystemActor.WaitFrame(30)
    # You are now in a deep slumber… dreaming peacefully of an island named ISLAND.
    MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:001_01', false)
    # When you wish to awaken from this dream, you need only lie down in this bed. I will take care of the rest.
    MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:002', false)
    if not System.EventFlags['cPlayer:TapFirstDreamIn']:
        # Also, should you have any questions or need advice about dreams, please do not hesitate to ask.
        MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:003', false)
        System.EventFlags['cPlayer:TapFirstDreamIn'] = true
    # And with that, may your dream of ISLAND be a sweet one.
    MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:004', true)
    EventFlowSystemActor.PlayerBaggageOperationForEvent('cRemove')
    System.EventFlags['cLandTemp:TapDreamFirstTalkDone'] = true
    EventFlowSystemActor.StartMeasurePlayTime('cDreaming')
    EventFlowSystemActor.SetEnableDofFadeForDream()
 
flow Wakeup():
    Player.PlayerStartAnimeBedWaitOpenEyes()
    EventFlowSystemActor.CameraSetDemoParam('InDreamZoomOut', 'cDefault', 'Player', false, false, true, 0)
    # Is it time to wake, or shall I press the snooze bar and let you stay?
    MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:1001', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        EventFlowSystemActor.BGMPropertyControl(102)
        EventFlowSystemActor.SoundDuckingOn(42)
        EventFlowSystemActor.MiniGameSilentCancel()
        EventFlowSystemActor.StopMeasurePlayTime('cDreaming')
        # Splendid! Please close your eyes… and relax… Now, imagine the shrill tones of an old alarm clock…<10:8:004b0000>
        MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:1002', false)
        EventFlowSystemActor.ChangeSwitchIdrDreamAromaPot(true)
        # When you open your eyes, you will be in your bed, and I will be gone. Until next time, PLAYER…<10:8:004b0000>
        MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:1003', true)
        Player.PlayerStartAnimeBedWaitWithHandsClasped()
        EventFlowSystemActor.WaitFrame(50)
        EventFlowSystemActor.CameraSetDemoParam('InDreamZoomIn', 'InDreamZoomInOut', 'Player', false, false, true, 0)
        EventFlowSystemActor.TapSmoke('cMainFieldSmoke')
        EventFlowSystemActor.SoundTriggerEmit('WipeDreamingToHome', -1)
        EventFlowSystemActor.NetExitDream(false)
        EventFlowSystemActor.BGMPropertyControl(103)
        EventFlowSystemActor.SoundSceneChangeFadeOutDucking(0)
        EventFlowSystemActor.SystemRequestChangeStage('cDreamDemo', 'cDream', 'cDream', 'cBlack', 1.0, 1.0)
    else:
        # A few more minutes? As you wish.
        MainNpc.OpenMessageWindow('TalkSNpc/tap/SP_tap_InDream:1004', false)
 
