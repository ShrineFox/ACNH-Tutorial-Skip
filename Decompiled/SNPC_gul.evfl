flow GulAfterQuest():
	if System.EventFlags['cLandTemp:JohnnyTalkShareplay']:
		# Oh! It's you again. I'm, uh, still dealing with my little dilemma here. Haven't been able to leave yet, obviously.
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:120', false)
		EventFlowSystemActor.ExitFlowchart()
	elif EventFlowSystemActor.HasKindItem('cKind', 'JohnnyQuest', ''):
		if EventFlowSystemActor.HasTargetItem(2381, 2):
			# Well, dock my boat! You found more of my missing <item>communicator parts! Thanks for helping! I'll take those sneaky little parts off your hands…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:082_pl', false)
		else:
			# Well, dock my boat! You found one of my missing <item>communicator parts! Thanks for helping! I'll take that sneaky little part off your hands…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:082', false)
		MainNpc.SetDeliveryItemAtRandom(2381, false, 'cVillageRemakePattern', 0)
		MainNpc.NpcDelivery(0, 'Keep')
		MainNpc.GulFreeAction('cGulActionType_PresentParts')
		MainNpc.NpcDelivery(3, '"Default"')
		# Can't believe I managed to send a message without all the parts shoved back in here. These must be some kind of bonus parts or something. Maybe they'…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:083', false)
		run GulClear()
		EventFlowSystemActor.ExitFlowchart()
	else:
		run GulAfterQuestChat()

flow GulAfterQuestChat():
	switch EventFlowSystemActor.RandomChoiceExcludePrevious3(3, true):
		case 0:
			# As long as my communicator works again, everything will be alright.
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:040_01', true)
		case 1:
			# Alright, I should receive a reply from them anytime now.
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:040_02', true)
		case 2:
			# I sent a quick heads-up to my shipmates.
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:040_03', true)
	MainNpc.SmartPhone(0)
	MainNpc.SmartPhone(4)
	# Let's see here… No replies yet…
	MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:041', true)
	MainNpc.SmartPhone(1)
	switch EventFlowSystemActor.RandomChoiceExcludePrevious3(3, true):
		case 0:
			# It says they read my message… I'll bet they're just busy planning my return celebration. Writing my name on a big banner, breaking out the GOOD soda……
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:042', false)
		case 1:
			# This little check mark means they definitely saw my message, right? Yeah. I'm sure they're en route.
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:043', false)
		case 2:
			# I bet my shipmates are already on their way over here! It says they read my message… Yep. Aaaaany minute now.
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:044', false)
	EventFlowSystemActor.ExitFlowchart()

flow GulClear():
	if not System.EventFlags['cPlayer:JohnnyQuestFinishFlag']:
		System.EventFlags['cLifeSupportAchievement:HelpGul'] += 1
		System.EventFlags['cPlayer:JohnnyHelpCount'] += 1
		System.EventFlags['cPlayer:JohnnyQuestFinishFlag'] = true
		System.EventFlags['cLand:JohnnyQuestFinishFlagIsland'] = true
		EventFlowSystemActor.SetMemoryEventPlayer('cBlancoEventPlayer:PE_GulA_Help')
	System.EventFlags['cPlayer:JohnnyQuestStartFlag'] = false
	MainNpc.GulFreeAction('cGulActionType_SetAnotherPlayerClearFlag')
	System.EventFlags['cLandTemp:JohnnyTalkShareplay'] = false
	System.EventFlags['cLandTemp:JohnnyClearShareplay'] = true

flow GulGivePartsForced():
	MainNpc.SetDeliveryItemAtRandom(2381, false, 'cVillageRemakePattern', 0)
	MainNpc.NpcDelivery(0, 'Keep')
	MainNpc.GulFreeAction('cGulActionType_PresentParts')
	MainNpc.NpcDelivery(3, '"Default"')

flow GulKeepSleep():
	# Hrmmmmph… Nope. Nuh-uh. Just…lemme sleep…
	MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:060', false)
	EventFlowSystemActor.ExitFlowchart()

flow GulQuestClear():
	EventFlowSystemActor.WaitFrame(4)
	MainNpc.CharacterEmoticonAction('Dance', false, '', 0, false)
	EventFlowSystemActor.WaitFrame(60)
	# Alright, the pieces are crammed back in here. Let's see if this thing can send a message.
	MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:033', true)
	MainNpc.SmartPhone(0)
	MainNpc.SmartPhone(4)
	# Ahoy there, crew! It's me, your brudder from anudder rudder! So listen…it happened again. Can you swing by to pick me up? Sending my coordinates now.…
	MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:036', true)
	MainNpc.SmartPhone(1)
	MainNpc.DecideEventReward('cJohnny')
	MainNpc.SetDeliveryItem(1, true)
	# You're the best! Thanks for all your help. I promise to return the favor. Be sure to check your mail in a few days. I'm gonna send you somethin' that…
	MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:034', false)
	# Ahhh, I'm saved! Nothin' to do now but pace back and forth for the next few hours. Better get started!
	MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:035', true)
	run GulClear()
	if System.EventFlags['cPlayer:JohnnyHelpCount'] != 30:
		switch EventFlowSystemActor.RandomChoice5(5):
			case 0:
				EventFlowSystemActor.SystemMailSend('cGul', 'MAIL_SNpc_gul', 1, 'cNone', 'cFastTomorrow', 'cReward', false, false)
			case 1:
				EventFlowSystemActor.SystemMailSend('cGul', 'MAIL_SNpc_gul', 2, 'cNone', 'cFastTomorrow', 'cReward', false, false)
			case 2:
				EventFlowSystemActor.SystemMailSend('cGul', 'MAIL_SNpc_gul', 3, 'cNone', 'cFastTomorrow', 'cReward', false, false)
			case 3:
				EventFlowSystemActor.SystemMailSend('cGul', 'MAIL_SNpc_gul', 4, 'cNone', 'cFastTomorrow', 'cReward', false, false)
			case 4:
				EventFlowSystemActor.SystemMailSend('cGul', 'MAIL_SNpc_gul', 5, 'cNone', 'cFastTomorrow', 'cReward', false, false)
	else:
		MainNpc.NpcSetRewardRecipe(8574, false)
		EventFlowSystemActor.SystemMailSend('cGul', 'MAIL_SNpc_gul', 6, 'cNone', 'cFastTomorrow', 'cReward', false, true)

flow GulQuestNow():
	if MainNpc.GulFreeQuery2('cGulQueryType_IsQuestClear'):
		# Hey! Did you find 'em?
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:030', false)
		if EventFlowSystemActor.GeneralTalkChoice2() == 0:
			MainNpc.SetDeliveryItemAtRandom(2381, false, 'cVillageRemakePattern', 0)
			MainNpc.NpcDelivery(0, 'Keep')
			MainNpc.GulFreeAction('cGulActionType_PresentParts')
			# Oh! That's them! Those are definitely my <item>communicator parts! C'mere, you little troublemakers…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:032', true)
			MainNpc.NpcDelivery(3, '"Default"')
			run GulQuestClear()
		else:
			run Sub_grp_Event211()
	else:
		run Sub_grp_Event211()

flow GulQuestNow_OtherClear():
	run Event173()

flow GulSitUp():
	# Mrmph…
	MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:065', true)
	MainNpc.SetDefaultWaitAs('cDefault')
	MainNpc.RequestSimple('GulGetUp', true)
	MainNpc.TurnBody(10, 0.0)
	System.EventFlags['cLand:JohnnySitUpFlag'] = true

flow GulStart():
	if System.EventFlags['cPlayer:JohnnyQuestStartFlag']:
		# If you can find <90:0:0000> <50:8:0000000a0070006100720074007300080070006100720074000a00700061007200740073>, I should be able to fix my communicator.…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:023', false)
	else:
		# The <item>communicator parts are probably buried in the sand somewhere. I'm just missing <90:0:0000> <50:8:0000000a0070006100720074007300080070006100…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:022', false)
	System.EventFlags['cPlayer:JohnnyQuestStartFlag'] = true
	System.EventFlags['cLandTemp:JohnnyTalkShareplay'] = true
	System.EventFlags['cPlayer:JohnnyAnotherPlayerClearFlag'] = false

flow GulTalkChk():
	if EventFlowSystemActor.IsMyVillage():
		System.EventFlags['cPlayer:JohnnyTalkBeforeFlag'] = true
		System.EventFlags['cLand:JohnnyTalkAnyPlayerFlag'] = true

flow GulTalkSleep():
	switch EventFlowSystemActor.RandomChoiceExcludePrevious10(10, true):
		case 0:
			# Zzz…nyam, nyam, nyam…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:001_01', false)
		case 1:
			# Mrrph…brrgh? Waiter, somebody put salt in this water… Zzz…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:001_02', false)
		case 2:
			# B'GUH! Who's at the helm? Just…gimme five more minutes…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:001_03', false)
		case 3:
			# AVAST! Storm's a-comin'! Brace yerselves, lads. Zzz… Hard to starboard! Tough to port? Stern to…stern…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:001_04', false)
		case 4:
			# Weigh anchor… Check its blood pressure. Who's your provider… Nyam, nyam…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:001_05', false)
		case 5:
			# T-the waves… The waves are…guh! Ready th' pool noodles! Zzz…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:001_06', false)
		case 6:
			# Nnnn, don't wanna be flotsam… Can I be jetsam? It just sounds… more rugged… Zzz…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:001_07', false)
		case 7:
			# Honk-shoo, honk-shoo… Snoring sounds, et cetera…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:001_08', false)
		case 8:
			# Zzz… No, YOU walk th' plank, Ahab… Think yer so smart. Zzz…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:001_09', false)
		case 9:
			# SNRRK, snrrk… Sorry, fellas. Already licked all these cookies. Had to…test for raisins. Zzz…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:001_10', false)
	EventFlowSystemActor.ExitFlowchart()

flow Gul_DC():
	if not System.EventFlags['cLand:JohnnySitUpFlag']:
		run GulKeepSleep()
	elif System.EventFlags['cLandTemp:JohnnyTalkShareplay']:
		switch EventFlowSystemActor.RandomChoiceExcludePrevious3(3, true):
			case 0:
				# Hmm. My ship should have arrived by now. Must be stuck in traffic!
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:062_01', false)
			case 1:
				# Scanning the ol' horizon. It's just sea, sea, and more sea as far as the eye can…see. Y'see?
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:062_02', false)
			case 2:
				# Say, how did YOU wind up here? Are you marooned too? You do have the wild eyes of a castaway…
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:062_03', false)
	else:
		switch EventFlowSystemActor.RandomChoiceExcludePrevious3(3, true):
			case 0:
				# Ahoy there! I'm a sailor traveling the seven seas. Call me Gulliver! Maybe we'll cross paths again someday! No way of knowing… but that's how travel …
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:061_01', false)
			case 1:
				# Hello! I'm Gulliver, the well-traveled sailor! Are you a visitor here? Neat! So am I. We're like two ships passing in the night, eh? I must seem so m…
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:061_02', false)
			case 2:
				# This island seems pretty neat! What's your island like? Wait! Don't tell me. I want it to be a surprise. I'm sure I'll wash up on— err, VISIT it soon…
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:061_03', false)

flow Gul_GetUp_NotStart():
	run GulSitUp()
	if MainNpc.GulFreeQuery2('cGulQueryType_OtherPlayerQuestNow'):
		# Oh! Hi! Thanks for waking me up. Blech! Mouth tastes like sand…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:100', false)
		# I'm Gulliver, a salty sailor scouring these seven seas, see?
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:101', false)
		# More specifically, I was scouring this beach for something…but I guess I wore myself out and fell asleep.
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:102', false)
		# You look confused. Let me back up. See, I was sailing with my crew, fell overboard, and washed up here! Sail, fail, wash up and tell the tale. It's a…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:103', false)
	else:
		if MainNpc.GulFreeQuery2('cGulQueryType_OtherPlayerClear'):
			# Oh! Hi! Thanks for waking me up. Blech! Mouth tastes like sand…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:100', false)
			# I'm Gulliver, a salty sailor scouring these seven seas, see?
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:101', false)
			# My brain was seriously overloaded. Got a lot going on. Thought a power nap might fit the bill, y'know?
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:105', false)
			# You look confused. Let me back up. See, I was sailing with my crew, fell overboard, and washed up here! Sail, fail, wash up and tell the tale. It's a…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:106', false)
			MainNpc.SmartPhone(6)
			# Yep. Should be getting a response from my crew any minute now…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:106_01', false)
			MainNpc.SmartPhone(4)
			# <10:12>Wait. What? <10:10>OHMIGOSH!<10:9> My trusty communicator is busted! AGAIN! Those parts must have come loose during my nap! The waves probably…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:107', false)
			MainNpc.SmartPhone(5)
			# As long as this thing is busted, I won't be able to get any messages from my crew! The parts must be buried in the sand somewhere on this island. Can…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:108', false)
		else:
			if System.EventFlags['cPlayer:JohnnySitUpBeforeFlag']:
				switch EventFlowSystemActor.RandomChoice4(4):
					case 0:
						# G-good morning! Or evening? Vision's fuzzy… How are you this fine whatever-time-of-day-it-is? Say, is that my favorite landlubber, PLAYER? It is! Aho…
						MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:005', false)
						# There I was, battling a dozen—no, TWO dozen sea monsters! I was holding my own…until one of 'em landed a devastating tickle attack. Sent me tumblin' …
						MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:006', false)
					case 1:
						# "But, verily, it be the nature of dreams to end…" SNRRK! GUH! Who?! What? Where? And I'll throw in when and why at no extra charge! You there! What's…
						MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:008', false)
						# Hm? "What was that 'verily' stuff about?" Not sure! I think I heard a fish say it once. Anyway… I guess I must've fallen overboard and washed up on t…
						MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:009', false)
					case 2:
						# NO! Don't make me go back to space! It's cold and dark and—huh? I'm…not in space? Phew! Good ol' terra firma. Oh! It's you, PLAYER! Were you the one …
						MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:011', false)
						# Will you hang with me till the hurting stops? You've got a face that screams "ample free time." So, as I was saying, I must have slipped over the sid…
						MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:012', false)
					case 3:
						# Hooooo boy. Up we go. On your feet, sailor. This isn't our first mystery beach and it won't be our last… Blugh… Swallowed a LOT of seawater… Come on,…
						MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:014', false)
						# Wait, I know you! You're…Rusty? No! You're PLAYER! Hey! How've you been? As for me, I'm still trapped in a will-they-won't-they relationship with tha…
						MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:015', false)
			else:
				System.EventFlags['cPlayer:JohnnySitUpBeforeFlag'] = true
				# Blerrrgh… D-do you have my pickled-herring pizza? I already tipped online, so… Wait—I don't see a pizza! Where am I? Who are you? Who am I?! Oh, hang…
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:002', false)
				# Thanks for the wake-up call! Those tasty hallucinations tend to sneak up on me… Can you find it in your heart to forgive this waterlogged birdbrain? …
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:003', false)
				# Guess I dozed off and tumbled overboard again… That's an endearing character trait of mine. My crewmates love it when I slip over the bow! HA! Don't …
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:004', false)
			MainNpc.SmartPhone(6)
			# I'll just call for help using my handy-dandy…uh.
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:018', false)
			MainNpc.SmartPhone(4)
			# <10:12>M-my, uh… <10:10>OH MY GOSH!<10:9> My handy-dandy communicator is broken! This isn't handy OR dandy!
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:018_01', false)
			MainNpc.SmartPhone(5)
			# Aww, sardines! It's all cracked and busted… Looks like it's missing a few <item>communicator parts too… That means…I'll have to wait for my crew to f…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:018_02', false)
			# RANDOM: You! Yes, you! Will you help me find my… // I'll look for 'em. // No way! // I'm begging you here! Will you look for… // I'll look for 'em. // No way!
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:019', false)
	if EventFlowSystemActor.GeneralTalkChoice2() == 0:
		# RANDOM: Really?! Wow! I haven't gotten a recept… // Oh, thank you! Thank you! Your heart mu…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:020', false)
	else:
		# RANDOM: Oof. I haven't received a cold shoulder… // Really? Wow. OK, uh…hmm. And I thought …
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:021', false)
	run GulStart()
	MainNpc.SmartPhone(1)
	EventFlowSystemActor.ExitFlowchart()

flow Gul_GetUp_Start():
	run GulSitUp()
	# Oh! Ahoy! You're that skipper from earlier, right? Thanks for the wake-up call.
	MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:080', false)
	if System.EventFlags['cPlayer:JohnnyAnotherPlayerClearFlag']:
		# A generous, heroic local found all of my missing <item>communicator parts! This island is overflowing with friendly skippers! It's enough to make a s…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:112', false)
		# With my mind finally at ease, the exhaustion took hold. Hit me like a fancy yacht doing 40 knots. I'm not ashamed to say, I passed right out!
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:113', false)
		MainNpc.SmartPhone(6)
		# Now that I'm upright and back to full blabbin' strength, I really should contact my shipmates.
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:113_01', false)
		MainNpc.SmartPhone(4)
		# <10:12>Wait. What? <10:10>OHMIGOSH!<10:9> My trusty communicator is busted! AGAIN! Those parts must have come loose during my nap! The waves probably…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:107', false)
		MainNpc.SmartPhone(5)
		# Thanks to the cruel whims of that smug jerk we call fate, I can't get any messages from my crew! The missing parts must be buried in the sand on thes…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:114', false)
		MainNpc.SmartPhone(1)
		run GulStart()
		MainNpc.SmartPhone(1)
		EventFlowSystemActor.ExitFlowchart()
	else:
		# I was, uh, just taking a quick power nap. Getting un-stranded is really exhausting, y'know? Please keep searching for my missing <item>communicator p…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:110', false)
		run GulStart()
		EventFlowSystemActor.ExitFlowchart()

flow Gul_Share():
	if not System.EventFlags['cLand:JohnnySitUpFlag']:
		if System.EventFlags['cPlayer:JohnnyQuestFinishFlag']:
			run GulKeepSleep()
		elif System.EventFlags['cPlayer:JohnnyQuestStartFlag']:
			run Gul_GetUp_Start()
		else:
			run Gul_GetUp_NotStart()
	elif System.EventFlags['cLandTemp:JohnnyClearShareplay']:
		if System.EventFlags['cLandTemp:JohnnyTalkShareplay']:
			run Sub_grp_Event93()
		else:
			if System.EventFlags['cPlayer:JohnnyQuestFinishFlag']:
				run GulAfterQuestChat()
			else:
				if System.EventFlags['cPlayer:JohnnyQuestStartFlag']:
entrypoint Event173:
					# Oh! You're the skipper from before!
					MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:126', false)
				else:
					# I'm Gulliver, an eager sailor who'd love to have an adventure that doesn't start with "mis" someday.
					MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:121', false)
					# What's my sad tale, you're probably dying to ask? I was thrown from my boat and washed up on this island! I lost a few <item>communicator parts in th…
					MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:125', false)
				# A generous, heroic local found all of my missing <item>communicator parts! This island is overflowing with friendly skippers! It's enough to make a s…
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:112', false)
				# Let's see… Should be getting a response from my crew aaaany minute now.
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:127', false)
				MainNpc.SmartPhone(6)
				# Yep. A happy reply from my happy shipmates on this happy, perfectly functioning little…
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:127_01', false)
				MainNpc.SmartPhone(4)
				# <10:12>Er, huh? <10:10>OHMIGOSH!<10:9> My trusty communicator is broken… AGAIN! How? Why?!
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:128', false)
				MainNpc.SmartPhone(5)
				# I'll never find my way back at this rate! I must be missing even more <item>communicator parts than I thought… Will you do this sorry sailor a solid …
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:128_01', false)
				run GulStart()
				MainNpc.SmartPhone(1)
				EventFlowSystemActor.ExitFlowchart()
	else:
		System.EventFlags['cLandTemp:JohnnyTalkShareplay'] = true
		run Sub_grp_Event93()

flow Root():
	EventFlowSystemActor.SetTagFromSystem('cEventFlag', 'cDegit', 0, 0, 'cLand:JohnnyRequirePartsNum')
	run GulTalkChk()
	if EventFlowSystemActor.IsSharePlay(0):
		run Gul_Share()
	elif not EventFlowSystemActor.IsMyVillage():
		run Gul_DC()
	elif System.EventFlags['cLand:JohnnySitUpFlag']:
		if System.EventFlags['cPlayer:JohnnyQuestFinishFlag']:
			run GulAfterQuest()
		elif System.EventFlags['cPlayer:JohnnyQuestStartFlag']:
			run GulQuestNow()
		else:
			run GulAfterQuest()
	elif not System.EventFlags['cPlayer:JohnnyQuestFinishFlag']:
		if System.EventFlags['cPlayer:JohnnyQuestStartFlag']:
			run Gul_GetUp_Start()
		else:
			System.EventFlags['cPlayer:JonnyTalkCount'] += 1
			if System.EventFlags['cPlayer:JonnyTalkCount'] == 1:
				run GulTalkSleep()
			elif EventFlowSystemActor.PercentChoice(10):
				run Gul_GetUp_NotStart()
			elif System.EventFlags['cPlayer:JonnyTalkCount'] < 6:
				run GulTalkSleep()
			else:
				run Gul_GetUp_NotStart()
	elif EventFlowSystemActor.HasKindItem('cKind', 'JohnnyQuest', ''):
		run GulSitUp()
		# Oh! Ahoy! You're that skipper from earlier, right? Thanks for the wake-up call.
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:080', false)
		if MainNpc.GulFreeQuery2('cGulQueryType_OtherPlayerQuestNow'):
			if EventFlowSystemActor.HasTargetItem(2381, 2):
				# I managed to get my communicator working with the parts you dug up… But it's still kind of busted. It won't even play my games anymore! I'm guessing …
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:084_pl', false)
			else:
				# I managed to get my communicator working with the parts you dug up… But it's still kind of busted. It won't even play my games anymore! I'm guessing …
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:084', false)
			run GulGivePartsForced()
			# This is great! More parts means this thing will be back to normal in no time! Thanks and thanks again, skipper!
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:085', false)
		else:
			# I was just, uh, keeping an eye out for my shipmates when I was hit by a wave…of the sleepies.
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:081', false)
			if EventFlowSystemActor.HasTargetItem(2381, 2):
				# Well, dock my boat! You found more of my missing <item>communicator parts! Thanks for helping! I'll take those sneaky little parts off your hands…
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:082_pl', false)
			else:
				# Well, dock my boat! You found one of my missing <item>communicator parts! Thanks for helping! I'll take that sneaky little part off your hands…
				MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:082', false)
			run GulGivePartsForced()
			# Can't believe I managed to send a message without all the parts shoved back in here. These must be some kind of bonus parts or something. Maybe they'…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:083', false)
		run GulClear()
	else:
		run GulKeepSleep()

local flow Sub_grp_Event211():
	switch EventFlowSystemActor.RandomChoiceExcludePrevious5(5, true):
		case 0:
			# My <item>communicator parts are definitely buried in the sand on this island's beaches. I just know it. But…if that's the case, there's nothing I can…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:031_01', false)
		case 1:
			# My <item>communicator parts won't be sitting out in the open. They're too cunning for that… They must be buried in the sand somewhere. Keep your shov…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:031_02', false)
		case 2:
			# Hey, <item>communicator parts! Come out, come out wherever you are! No answer. What gives? It's like they've clammed up all of a sudden! Buried their…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:031_03', false)
		case 3:
			# After you've found all <90:0:0000> of my <item>communicator parts, just bring 'em right here! I'll do the rest.
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:031_04', false)
		case 4:
			# I'm not sure how many different <item>communicator parts are out there. I could probably cram about <90:0:0000> of them in here. Then it might work a…
			MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:031_05', false)

local flow Sub_grp_Event93():
	if System.EventFlags['cPlayer:JohnnyQuestFinishFlag']:
		run GulAfterQuest()
	elif not System.EventFlags['cPlayer:JohnnyQuestStartFlag']:
		# I'm Gulliver, an eager sailor who'd love to have an adventure that doesn't start with "mis" someday.
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:121', false)
		# Take today's epic tale, for instance! Thrown from my ship, I was! Washed up on this fair island. It gets more harrowing from there! My communicator g…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:122', false)
		# Oh well. All I can do now is hope that these are the self-combing kinds of beaches. Wait! I have a better idea! Can you spare a minute to watch a bro…
		MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gul:123', false)
		run GulStart()
		EventFlowSystemActor.ExitFlowchart()
	elif System.EventFlags['cPlayer:JohnnyAnotherPlayerClearFlag']:
		run GulQuestNow_OtherClear()
	else:
		run GulQuestNow()
