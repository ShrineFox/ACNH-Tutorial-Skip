flow Chk_Clear():
	System.EventFlags['cPlayer:OwlClearCount'] = 0
	if EventFlowSystemActor.IsMyVillage():
		if (not System.EventFlags['cPlayer:OwlStampGotFish']) and (System.EventFlags['cPlayer:OwlFishStampRally1']) and (System.EventFlags['cPlayer:OwlFishStampRally2']) and (System.EventFlags['cPlayer:OwlFishStampRally3']):
			System.EventFlags['cPlayer:OwlClearCount'] += 1
		if (not System.EventFlags['cPlayer:OwlStampGotInsect']) and (System.EventFlags['cPlayer:OwlInsectStampRally1']) and (System.EventFlags['cPlayer:OwlInsectStampRally2']) and (System.EventFlags['cPlayer:OwlInsectStampRally3']):
			System.EventFlags['cPlayer:OwlClearCount'] += 1
		if (not System.EventFlags['cPlayer:OwlStampGotFossil']) and (System.EventFlags['cPlayer:OwlFossilStampRally1']) and (System.EventFlags['cPlayer:OwlFossilStampRally2']) and (System.EventFlags['cPlayer:OwlFossilStampRally3']):
			System.EventFlags['cPlayer:OwlClearCount'] += 1
		if (not System.EventFlags['cPlayer:OwlStampGotArt']) and (System.EventFlags['cPlayer:OwlArtStampRally1']) and (System.EventFlags['cPlayer:OwlArtStampRally2']) and (System.EventFlags['cPlayer:OwlArtStampRally3']):
			System.EventFlags['cPlayer:OwlClearCount'] += 1
	else:
		if (not System.EventFlags['cPlayerVisit:OwlStampGotFish']) and (System.EventFlags['cPlayerVisit:OwlFishStampRally1']) and (System.EventFlags['cPlayerVisit:OwlFishStampRally2']) and (System.EventFlags['cPlayerVisit:OwlFishStampRally3']):
			System.EventFlags['cPlayer:OwlClearCount'] += 1
		if (not System.EventFlags['cPlayerVisit:OwlStampGotInsect']) and (System.EventFlags['cPlayerVisit:OwlInsectStampRally1']) and (System.EventFlags['cPlayerVisit:OwlInsectStampRally2']) and (System.EventFlags['cPlayerVisit:OwlInsectStampRally3']):
			System.EventFlags['cPlayer:OwlClearCount'] += 1
		if (not System.EventFlags['cPlayerVisit:OwlStampGotFossil']) and (System.EventFlags['cPlayerVisit:OwlFossilStampRally1']) and (System.EventFlags['cPlayerVisit:OwlFossilStampRally2']) and (System.EventFlags['cPlayerVisit:OwlFossilStampRally3']):
			System.EventFlags['cPlayer:OwlClearCount'] += 1
		if (not System.EventFlags['cPlayerVisit:OwlStampGotArt']) and (System.EventFlags['cPlayerVisit:OwlArtStampRally1']) and (System.EventFlags['cPlayerVisit:OwlArtStampRally2']) and (System.EventFlags['cPlayerVisit:OwlArtStampRally3']):
			System.EventFlags['cPlayer:OwlClearCount'] += 1

flow Chk_Comp():
	if EventFlowSystemActor.IsMyVillage():
		if (System.EventFlags['cPlayer:OwlStampGotInsect']) and (System.EventFlags['cPlayer:OwlStampGotFish']) and (System.EventFlags['cPlayer:OwlStampGotFossil']) and ((EventFlowSystemActor.MuseumLevel() in (`BlathersNotMovedIn`, `BlathersTent`, `BlathersMuseumNoArt`)) or (System.EventFlags['cPlayer:OwlStampGotArt'])):
			run Sub_Event338()
		else:
			# Now, should you find yourself exploring the other exhibit rooms, do try collecting stamps there. Someone such as yourself is sure to find it a worthy…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:031', false)
	else:
		if (System.EventFlags['cPlayerVisit:OwlStampGotInsect']) and (System.EventFlags['cPlayerVisit:OwlStampGotFish']) and (System.EventFlags['cPlayerVisit:OwlStampGotFossil']) and ((EventFlowSystemActor.MuseumLevel() in (`BlathersNotMovedIn`, `BlathersTent`, `BlathersMuseumNoArt`)) or (System.EventFlags['cPlayerVisit:OwlStampGotArt'])):
			run Sub_Event338()
		else:
			# Now, should you find yourself exploring the other exhibit rooms, do try collecting stamps there. Someone such as yourself is sure to find it a worthy…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:031', false)

flow Chk_NotGetItem():
	if EventFlowSystemActor.IsMyVillage():
		if System.EventFlags['cPlayer:OwlStampPocketWasFull']:
			if (System.EventFlags['cPlayer:OwlStampGotFish']) and (not System.EventFlags['cPlayer:OwlStampGotFishReward']):
				run Sub_Event284()
			elif (System.EventFlags['cPlayer:OwlStampGotInsect']) and (not System.EventFlags['cPlayer:OwlStampGotInsectReward']):
				run Sub_Event285()
			elif (System.EventFlags['cPlayer:OwlStampGotFossil']) and (not System.EventFlags['cPlayer:OwlStampGotFossilReward']):
				run Sub_Event289()
			elif (System.EventFlags['cPlayer:OwlStampGotArt']) and (not System.EventFlags['cPlayer:OwlStampGotArtReward']):
				run Sub_Event304()
	elif System.EventFlags['cPlayerVisit:OwlStampPocketWasFull']:
		if (System.EventFlags['cPlayerVisit:OwlStampGotFish']) and (not System.EventFlags['cPlayerVisit:OwlStampGotFishReward']):
			run Sub_Event284()
		elif (System.EventFlags['cPlayerVisit:OwlStampGotInsect']) and (not System.EventFlags['cPlayerVisit:OwlStampGotInsectReward']):
			run Sub_Event285()
		elif (System.EventFlags['cPlayerVisit:OwlStampGotFossil']) and (not System.EventFlags['cPlayerVisit:OwlStampGotFossilReward']):
			run Sub_Event289()
		elif (System.EventFlags['cPlayerVisit:OwlStampGotArt']) and (not System.EventFlags['cPlayerVisit:OwlStampGotArtReward']):
			run Sub_Event304()

flow Chk_Pocket():
	if EventFlowSystemActor.IsMyVillage():
		if System.EventFlags['cPlayer:OwlStampPocketWasFull']:
			# Hoo-hoo! I see you've made room in your pockets. In that case, here is the memento you were promised.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:018', false)
		else:
			# And without any further ado, here is the memento I promised you.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:017', false)
	else:
		if System.EventFlags['cPlayerVisit:OwlStampPocketWasFull']:
			# Hoo-hoo! I see you've made room in your pockets. In that case, here is the memento you were promised.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:018', false)
		else:
			# And without any further ado, here is the memento I promised you.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:017', false)
	if EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1:
		if EventFlowSystemActor.IsMyVillage():
			System.EventFlags['cPlayer:OwlStampPocketWasFull'] = true
		else:
			System.EventFlags['cPlayerVisit:OwlStampPocketWasFull'] = true
		# Eh wot?! Your pockets! They're stuffed to bursting. Come back once you've organized yourself, and I shall give you your commemorative item.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:014', false)
		EventFlowSystemActor.ExitFlowchart()
	else:
		if EventFlowSystemActor.IsMyVillage():
			System.EventFlags['cPlayer:OwlStampPocketWasFull'] = false
		else:
			System.EventFlags['cPlayerVisit:OwlStampPocketWasFull'] = false

flow Cmn_Present():
	MainNpc.SetDeliveryItemAtRandom(12484, false, 'cVillageRemakePattern', 0)
	MainNpc.NpcDelivery(1, 'Default')

flow CompCheck():
	if EventFlowSystemActor.IsMyVillage():
		if (System.EventFlags['cPlayer:OwlStampGotInsect']) and (System.EventFlags['cPlayer:OwlStampGotFish']) and (System.EventFlags['cPlayer:OwlStampGotFossil']):
			# Hoot and wot wot?! You've collected all the stamps available today? To think you've enjoyed the Stamp Rally to such a degree! I can't help but puff m…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:032', false)
		else:
			# Now, should you find yourself exploring the other exhibit rooms, do try collecting stamps there. Someone such as yourself is sure to find it a worthy…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:031', false)
	elif (System.EventFlags['cPlayerVisit:OwlStampGotInsect']) and (System.EventFlags['cPlayerVisit:OwlStampGotFish']) and (System.EventFlags['cPlayerVisit:OwlStampGotFossil']):
		# Hoot and wot wot?! You've collected all the stamps available today? To think you've enjoyed the Stamp Rally to such a degree! I can't help but puff m…
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:032', false)
	else:
		# Now, should you find yourself exploring the other exhibit rooms, do try collecting stamps there. Someone such as yourself is sure to find it a worthy…
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:031', false)

flow From2ndTime():
	if EventFlowSystemActor.TermEventNow('InternationalMuseum', false):
		if EventFlowSystemActor.IsMyVillage():
			if System.EventFlags['cPlayer:OwlStampPocketWasFull']:
				if EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') >= 1:
					run Judge()
			else:
				if System.EventFlags['cPlayer:StampRallyRunningForPlayer']:
					run Judge()
				else:
					if System.EventFlags['cPlayer:OwlStampPlayed']:
						run Start()
					else:
						# That reminds me! I have exciting news, PLAYER.
						MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:001', false)
						run Start()
		elif System.EventFlags['cPlayerVisit:OwlStampPocketWasFull']:
			if EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') >= 1:
				run Judge()
		else:
			if System.EventFlags['cPlayerVisit:StampRallyRunningForPlayer']:
				run Judge()
			else:
				# By the by, we are currently hosting a Stamp Rally in honor of International Museum Day, which is on May 18th.
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:002_02', false)
				# Please allow me a moment to give a brief explanation of precisely what this most esteemed day is… Ahem! International Museum Day is a day to understa…
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:002_03', false)
				if EventFlowSystemActor.MuseumLevel() in (`BlathersNotMovedIn`, `BlathersTent`, `BlathersMuseumNoArt`):
					# Now! The Stamp Rally works thusly… The bug, fish, and fossil galleries each have 3 stamp stations…
					MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:003_02', false)
				else:
					# Now! The Stamp Rally works thusly… The bug, fish, fossil, and art galleries each have 3 stamp stations…
					MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:003_01', false)
				# You must find the stations in each gallery and acquire their stamps. Do so, and you'll earn a memento. There are several unique mementos— one for com…
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:003_03', false)
				run QuestJoin()

flow Get_Item():
	EventFlowSystemActor.MessageSuspend()
	MainNpc.SetDeliveryItem(1, true)
	MainNpc.NpcDelivery(1, 'Default')
	MainNpc.SetItemName(1, 4, 0)
	# I present to you…your very own <125:4:0000>!
	MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:019', false)

flow GotReward():
	if EventFlowSystemActor.IsMyVillage():
		if System.EventFlags['cPlayer:OwlStampGotRewardExplain']:
			# Yes, a completion stamp is in order at this juncture. Hoot, here you go!
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:026', false)
		else:
			System.EventFlags['cPlayer:OwlStampGotRewardExplain'] = true
			# Why, to think that you would join in, even though you've already earned your commemorative item! Truly, I am honored! Your dedication to and enthusia…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:025', false)
	elif System.EventFlags['cPlayerVisit:OwlStampGotRewardExplain']:
		# Yes, a completion stamp is in order at this juncture. Hoot, here you go!
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:026', false)
	else:
		System.EventFlags['cPlayerVisit:OwlStampGotRewardExplain'] = true
		# Why, to think that you would join in, even though you've already earned your commemorative item! Truly, I am honored! Your dedication to and enthusia…
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:025', false)

flow Judge():
	SubflowResults[1] = 0
	run Chk_NotGetItem()
	run Chk_Clear()
	if System.EventFlags['cPlayer:OwlClearCount'] != 0:
		if System.EventFlags['cPlayer:OwlClearCount'] < 2:
			# Hoo-hoo? I see you've collected a set of stamps!
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:010', false)
		else:
			# Is that a set of stamps I see? Hoo-hoo! It's several, in fact!
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:010_01', false)
		SubflowResults[0] = 0
		run Stamp_Fish()
		run Stamp_Insect()
		run Stamp_Fossil()
		run Stamp_Art()
		run Chk_Comp()
		EventFlowSystemActor.ExitFlowchart()
	else:
		if SubflowResults@2[1] == 1:
			run Chk_Comp()
			EventFlowSystemActor.ExitFlowchart()

flow PocketChk():
	if EventFlowSystemActor.SystemHasBaggageSpace('cPocketBag') < 1:
		if EventFlowSystemActor.IsMyVillage():
			System.EventFlags['cPlayer:OwlStampPocketWasFull'] = true
		else:
			System.EventFlags['cPlayerVisit:OwlStampPocketWasFull'] = true
		# Eh wot?! Your pockets! They're stuffed to bursting. Come back once you've organized yourself, and I shall give you your commemorative item.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:014', false)
		EventFlowSystemActor.ExitFlowchart()
	else:
		if EventFlowSystemActor.IsMyVillage():
			System.EventFlags['cPlayer:OwlStampPocketWasFull'] = false
		else:
			System.EventFlags['cPlayerVisit:OwlStampPocketWasFull'] = false

flow QuestJoin():
	if EventFlowSystemActor.IsMyVillage():
		System.EventFlags['cPlayer:StampRallyRunningForPlayer'] = true
		System.EventFlags['cPlayer:OwlStampPlayed'] = true
	else:
		System.EventFlags['cPlayerVisit:StampRallyRunningForPlayer'] = true
	EventFlowSystemActor.ExitFlowchart()

flow Root():
	if EventFlowSystemActor.TermEventNow('InternationalMuseum', false):
		run Start()

flow Stamp1():
	if EventFlowSystemActor.IsMyVillage():
		if (not System.EventFlags['cPlayer:OwlStampGotInsect']) and (System.EventFlags['cPlayer:OwlInsectStampRally1']) and (System.EventFlags['cPlayer:OwlInsectStampRally2']) and (System.EventFlags['cPlayer:OwlInsectStampRally3']):
			if System.EventFlags['cPlayer:OwlStampPocketWasFull']:
				# That's more like it. Organizing one's pockets feels good, no? Now, here is that Stamp Rally memento you earned.
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:015', false)
			else:
				# By my beak! You've finished the Stamp Rally in the bug exhibit! Your willingness to explore the bug rooms with such gusto is…admirable. I, myself, fi…
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:011', false)
	elif (not System.EventFlags['cPlayerVisit:OwlStampGotInsect']) and (System.EventFlags['cPlayerVisit:OwlInsectStampRally1']) and (System.EventFlags['cPlayerVisit:OwlInsectStampRally2']) and (System.EventFlags['cPlayerVisit:OwlInsectStampRally3']):
		if System.EventFlags['cPlayerVisit:OwlStampPocketWasFull']:
			# That's more like it. Organizing one's pockets feels good, no? Now, here is that Stamp Rally memento you earned.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:015', false)
		else:
			# By my beak! You've finished the Stamp Rally in the bug exhibit! Your willingness to explore the bug rooms with such gusto is…admirable. I, myself, fi…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:011', false)
		if System.EventFlags['cPlayer:OwlStampGotInsectReward']:
			# Wot wot?! It seems you've already acquired the memento for the bug rally today, PLAYER…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:022', false)
			run GotReward()
		else:
			run PocketChk()
			run Cmn_Present()
			EventFlowSystemActor.SetItemToPocket(12485, 1)
			System.EventFlags['cPlayer:OwlStampGotInsectReward'] = true
			# Jolly good. I shall now present you with the completion stamp.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:021', false)
		EventFlowSystemActor.UIStampRallyMuseumFromOwlHandling('cInsect')
		if EventFlowSystemActor.IsMyVillage():
			System.EventFlags['cPlayer:OwlStampGotInsect'] = true
		else:
			System.EventFlags['cPlayerVisit:OwlStampGotInsect'] = true
		run CompCheck()
		EventFlowSystemActor.ExitFlowchart()

flow Stamp2():
	if EventFlowSystemActor.IsMyVillage():
		if (not System.EventFlags['cPlayer:OwlStampGotFish']) and (System.EventFlags['cPlayer:OwlFishStampRally1']) and (System.EventFlags['cPlayer:OwlFishStampRally2']) and (System.EventFlags['cPlayer:OwlFishStampRally3']):
			if System.EventFlags['cPlayer:OwlStampPocketWasFull']:
				# That's more like it. Organizing one's pockets feels good, no? Now, here is that Stamp Rally memento you earned.
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:015', false)
			else:
				# Hoot! I say, hoo! Look at you! You've finished the Stamp Rally in the fish gallery! I say, did you happen to take any photographs of your quest? Your…
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:012', false)
	elif (not System.EventFlags['cPlayerVisit:OwlStampGotFish']) and (System.EventFlags['cPlayerVisit:OwlFishStampRally1']) and (System.EventFlags['cPlayerVisit:OwlFishStampRally2']) and (System.EventFlags['cPlayerVisit:OwlFishStampRally3']):
		if System.EventFlags['cPlayerVisit:OwlStampPocketWasFull']:
			# That's more like it. Organizing one's pockets feels good, no? Now, here is that Stamp Rally memento you earned.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:015', false)
		else:
			# Hoot! I say, hoo! Look at you! You've finished the Stamp Rally in the fish gallery! I say, did you happen to take any photographs of your quest? Your…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:012', false)
		if System.EventFlags['cPlayer:OwlStampGotFishReward']:
			# I say! What's this? It appears you've already earned the memento for the fish rally today, PLAYER…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:023', false)
			run GotReward()
		else:
			run PocketChk()
			run Cmn_Present()
			EventFlowSystemActor.SetItemToPocket(12486, 1)
			System.EventFlags['cPlayer:OwlStampGotFishReward'] = true
			# Jolly good. I shall now present you with the completion stamp.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:021', false)
		EventFlowSystemActor.UIStampRallyMuseumFromOwlHandling('cFish')
		if EventFlowSystemActor.IsMyVillage():
			System.EventFlags['cPlayer:OwlStampGotFish'] = true
		else:
			System.EventFlags['cPlayerVisit:OwlStampGotFish'] = true
		run CompCheck()
		EventFlowSystemActor.ExitFlowchart()

flow Stamp3():
	if EventFlowSystemActor.IsMyVillage():
		if (not System.EventFlags['cPlayer:OwlStampGotFossil']) and (System.EventFlags['cPlayer:OwlFossilStampRally1']) and (System.EventFlags['cPlayer:OwlFossilStampRally2']) and (System.EventFlags['cPlayer:OwlFossilStampRally3']):
			if System.EventFlags['cPlayer:OwlStampPocketWasFull']:
				# That's more like it. Organizing one's pockets feels good, no? Now, here is that Stamp Rally memento you earned.
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:015', false)
			else:
				# My feathers! You've finished the Stamp Rally in the fossil gallery! As the host of these rallies, it pleases me to my pinfeathers to see you frolic a…
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:013', false)
	elif (not System.EventFlags['cPlayerVisit:OwlStampGotFossil']) and (System.EventFlags['cPlayerVisit:OwlFossilStampRally1']) and (System.EventFlags['cPlayerVisit:OwlFossilStampRally2']) and (System.EventFlags['cPlayerVisit:OwlFossilStampRally3']):
		if System.EventFlags['cPlayerVisit:OwlStampPocketWasFull']:
			# That's more like it. Organizing one's pockets feels good, no? Now, here is that Stamp Rally memento you earned.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:015', false)
		else:
			# My feathers! You've finished the Stamp Rally in the fossil gallery! As the host of these rallies, it pleases me to my pinfeathers to see you frolic a…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:013', false)
		if System.EventFlags['cPlayer:OwlStampGotFossilReward']:
			# Say now, PLAYER! It looks as though you've already earned the memento for the fossil rally today…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:024', false)
			run GotReward()
		else:
			run PocketChk()
			run Cmn_Present()
			EventFlowSystemActor.SetItemToPocket(12484, 1)
			System.EventFlags['cPlayer:OwlStampGotFossilReward'] = true
			# Jolly good. I shall now present you with the completion stamp.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:021', false)
		EventFlowSystemActor.UIStampRallyMuseumFromOwlHandling('cFossil')
		if EventFlowSystemActor.IsMyVillage():
			System.EventFlags['cPlayer:OwlStampGotFossil'] = true
		else:
			System.EventFlags['cPlayerVisit:OwlStampGotFossil'] = true
		run CompCheck()
		EventFlowSystemActor.ExitFlowchart()

flow Stamp_Art():
	if EventFlowSystemActor.IsMyVillage():
		if (System.EventFlags['cPlayer:OwlArtStampRally1']) and (System.EventFlags['cPlayer:OwlArtStampRally2']) and (System.EventFlags['cPlayer:OwlArtStampRally3']):
			if not System.EventFlags['cPlayer:OwlStampGotArt']:
				run Sub_grp_Event196()
			elif System.EventFlags['cPlayer:OwlStampPocketWasFull']:
				run Sub_Event191()
	elif (System.EventFlags['cPlayerVisit:OwlArtStampRally1']) and (System.EventFlags['cPlayerVisit:OwlArtStampRally2']) and (System.EventFlags['cPlayerVisit:OwlArtStampRally3']):
		if not System.EventFlags['cPlayerVisit:OwlStampGotArt']:
			run Sub_grp_Event196()
		elif System.EventFlags['cPlayerVisit:OwlStampPocketWasFull']:
			run Sub_Event191()

flow Stamp_Fish():
	if EventFlowSystemActor.IsMyVillage():
		if (System.EventFlags['cPlayer:OwlFishStampRally1']) and (System.EventFlags['cPlayer:OwlFishStampRally2']) and (System.EventFlags['cPlayer:OwlFishStampRally3']):
			if not System.EventFlags['cPlayer:OwlStampGotFish']:
				run Sub_Event370()
			elif System.EventFlags['cPlayer:OwlStampPocketWasFull']:
				run Sub_Event274()
	elif (System.EventFlags['cPlayerVisit:OwlFishStampRally1']) and (System.EventFlags['cPlayerVisit:OwlFishStampRally2']) and (System.EventFlags['cPlayerVisit:OwlFishStampRally3']):
		if not System.EventFlags['cPlayerVisit:OwlStampGotFish']:
			run Sub_Event370()
		elif System.EventFlags['cPlayerVisit:OwlStampPocketWasFull']:
			run Sub_Event274()

flow Stamp_Fossil():
	if EventFlowSystemActor.IsMyVillage():
		if (System.EventFlags['cPlayer:OwlFossilStampRally1']) and (System.EventFlags['cPlayer:OwlFossilStampRally2']) and (System.EventFlags['cPlayer:OwlFossilStampRally3']):
			if not System.EventFlags['cPlayer:OwlStampGotFossil']:
				run Sub_grp_Event360()
			elif System.EventFlags['cPlayer:OwlStampPocketWasFull']:
				run Sub_Event169()
	elif (System.EventFlags['cPlayerVisit:OwlFossilStampRally1']) and (System.EventFlags['cPlayerVisit:OwlFossilStampRally2']) and (System.EventFlags['cPlayerVisit:OwlFossilStampRally3']):
		if not System.EventFlags['cPlayerVisit:OwlStampGotFossil']:
			run Sub_grp_Event360()
		elif System.EventFlags['cPlayerVisit:OwlStampPocketWasFull']:
			run Sub_Event169()

flow Stamp_Insect():
	if EventFlowSystemActor.IsMyVillage():
		if (System.EventFlags['cPlayer:OwlInsectStampRally1']) and (System.EventFlags['cPlayer:OwlInsectStampRally2']) and (System.EventFlags['cPlayer:OwlInsectStampRally3']):
			if not System.EventFlags['cPlayer:OwlStampGotInsect']:
				run Sub_grp_Event367()
			elif System.EventFlags['cPlayer:OwlStampPocketWasFull']:
				run Sub_Event273()
	elif (System.EventFlags['cPlayerVisit:OwlInsectStampRally1']) and (System.EventFlags['cPlayerVisit:OwlInsectStampRally2']) and (System.EventFlags['cPlayerVisit:OwlInsectStampRally3']):
		if not System.EventFlags['cPlayerVisit:OwlStampGotInsect']:
			run Sub_grp_Event367()
		elif System.EventFlags['cPlayerVisit:OwlStampPocketWasFull']:
			run Sub_Event273()

flow Start():
	if System.EventFlags['cPlayer:OwlStampPlayed']:
		# You know, we are still hosting the Stamp Rally today as well.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:008', false)
		if EventFlowSystemActor.MuseumLevel() in (`BlathersNotMovedIn`, `BlathersTent`, `BlathersMuseumNoArt`):
			if (System.EventFlags['cPlayer:OwlStampPlayedThisYear']) and (System.EventFlags['cPlayer:OwlStampPlayedThisYear2']) and (System.EventFlags['cPlayer:OwlStampPlayedThisYear3']):
				# Of course, there is still fun to be had even if you've already completed the Stamp Rally. The stamp stations move each day, you see. That way the ral…
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:008_01', false)
			else:
				# Oh my! It appears there may be a gallery or two whose stamps you have yet to collect! The mementos I have are different for each gallery you complete…
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:008_02', false)
		else:
			if System.EventFlags['cPlayer:OwlArtUnfinished']:
				System.EventFlags['cPlayer:OwlArtUnfinished'] = false
				# And it has expanded! Indeed, our new art gallery now has stamps for you to find! There is also a unique memento for you to collect once you've found …
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:008_03', false)
			elif (System.EventFlags['cPlayer:OwlStampPlayedThisYear']) and (System.EventFlags['cPlayer:OwlStampPlayedThisYear2']) and (System.EventFlags['cPlayer:OwlStampPlayedThisYear3']) and (System.EventFlags['cPlayer:OwlStampPlayedThisYear4']):
				# Of course, there is still fun to be had even if you've already completed the Stamp Rally. The stamp stations move each day, you see. That way the ral…
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:008_01', false)
			else:
				# Oh my! It appears there may be a gallery or two whose stamps you have yet to collect! The mementos I have are different for each gallery you complete…
				MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:008_02', false)
		run QuestJoin()
	else:
		# May 18th is International Museum Day, and to honor it, we're holding a Stamp Rally!
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:002_01', false)
		# Please allow me a moment to give a brief explanation of precisely what this most esteemed day is… Ahem! International Museum Day is a day to understa…
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:002_03', false)
		if EventFlowSystemActor.MuseumLevel() in (`BlathersNotMovedIn`, `BlathersTent`, `BlathersMuseumNoArt`):
			# Now! The Stamp Rally works thusly… The bug, fish, and fossil galleries each have 3 stamp stations…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:003_02', false)
			System.EventFlags['cPlayer:OwlArtUnfinished'] = true
		else:
			# Now! The Stamp Rally works thusly… The bug, fish, fossil, and art galleries each have 3 stamp stations…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:003_01', false)
		# You must find the stations in each gallery and acquire their stamps. Do so, and you'll earn a memento. There are several unique mementos— one for com…
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:003_03', false)
		run QuestJoin()

local flow Sub_Event169():
	run Chk_Pocket()
	EventFlowSystemActor.SelectRewardItemDirect(12484, 1, 'cVillageRemakePattern', 0)
	if EventFlowSystemActor.IsMyVillage():
		System.EventFlags['cPlayer:OwlStampGotFossilReward'] = true
		System.EventFlags['cPlayer:OwlStampPlayedThisYear3'] = true
	else:
		System.EventFlags['cPlayerVisit:OwlStampGotFossilReward'] = true
	run Get_Item()

local flow Sub_Event191():
	run Chk_Pocket()
	EventFlowSystemActor.SelectRewardItemDirect(14532, 1, 'cVillageRemakePattern', 0)
	if EventFlowSystemActor.IsMyVillage():
		System.EventFlags['cPlayer:OwlStampGotArtReward'] = true
		System.EventFlags['cPlayer:OwlStampPlayedThisYear4'] = true
	else:
		System.EventFlags['cPlayerVisit:OwlStampGotArtReward'] = true
	run Get_Item()

local flow Sub_Event273():
	run Chk_Pocket()
	EventFlowSystemActor.SelectRewardItemDirect(12485, 1, 'cVillageRemakePattern', 0)
	if EventFlowSystemActor.IsMyVillage():
		System.EventFlags['cPlayer:OwlStampGotInsectReward'] = true
		System.EventFlags['cPlayer:OwlStampPlayedThisYear2'] = true
	else:
		System.EventFlags['cPlayerVisit:OwlStampGotInsectReward'] = true
	run Get_Item()

local flow Sub_Event274():
	run Chk_Pocket()
	EventFlowSystemActor.SelectRewardItemDirect(12486, 1, 'cVillageRemakePattern', 0)
	if EventFlowSystemActor.IsMyVillage():
		System.EventFlags['cPlayer:OwlStampGotFishReward'] = true
		System.EventFlags['cPlayer:OwlStampPlayedThisYear'] = true
	else:
		System.EventFlags['cPlayerVisit:OwlStampGotFishReward'] = true
	run Get_Item()

local flow Sub_Event284():
	run Stamp_Fish()
	SubflowResults[1] = 1

local flow Sub_Event285():
	run Stamp_Insect()
	SubflowResults[1] = 1

local flow Sub_Event289():
	run Stamp_Fossil()
	SubflowResults[1] = 1

local flow Sub_Event304():
	run Stamp_Art()
	SubflowResults[1] = 1

local flow Sub_Event338():
	# Hoot and wot wot?! You've collected all the stamps available today? To think you've enjoyed the Stamp Rally to such a degree! I can't help but puff m…
	MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:033', false)
	if EventFlowSystemActor.IsMyVillage():
		if EventFlowSystemActor.EnvCheckBetweenDate(5, 31, 5, 31, 'cLastGrowUpTime'):
			# Sadly, today is the final day for this year's Stamp Rally.
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:034_01', false)
		else:
			# We'll be holding a Stamp Rally every day until May 31st. We even change the stamp stations each day! If you'd like to earn more of those same memento…
			MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:034', false)
	# Thank you so much for celebrating International Museum Day with us and taking part in our Stamp Rally. Sharing the wonders and knowledge our museum h…
	MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:035', false)

local flow Sub_Event370():
	# Jolly good! And now to mark your hard work with an aptly named completion stamp! Let's see…
	MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:010_02', false)
	SubflowResults[0] = 1
	EventFlowSystemActor.UIStampRallyMuseumFromOwlHandling('cFish')
	if EventFlowSystemActor.IsMyVillage():
		System.EventFlags['cPlayer:OwlStampGotFish'] = true
	else:
		System.EventFlags['cPlayerVisit:OwlStampGotFish'] = true
	# With that, you've finished the Stamp Rally in the fish gallery! Hoot! I say, hoo! Look at you!
	MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:012_01', false)
	if not EventFlowSystemActor.MuseumRoomDonateRate2(0, 0):
		# As I'm sure you saw, that gallery is currently quite empty.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_01', false)
		run Sub_Event404()
	elif EventFlowSystemActor.MuseumRoomDonateRate2(3, 0):
		# I say, did you happen to take any photographs of your quest? Your NookPhone takes marvelous photos. And the fish rooms make an elegant backdrop, to b…
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:012_02', false)
		run Sub_Event274()
	else:
		# As I'm sure you saw, that gallery still has quite a ways to go.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_02', false)
		run Sub_Event404()

local flow Sub_Event404():
	if EventFlowSystemActor.IsMyVillage():
		# It is my sincere hope that we receive enough donations to completely fill out our museum.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_03', false)
		run Sub_Event274()
	else:
		# We are always working to increase the number of exhibits on display, so I hope you'll visit us again soon!
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_04', false)
		run Sub_Event274()

local flow Sub_Event407():
	if EventFlowSystemActor.IsMyVillage():
		# It is my sincere hope that we receive enough donations to completely fill out our museum.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_03', false)
		run Sub_Event273()
	else:
		# We are always working to increase the number of exhibits on display, so I hope you'll visit us again soon!
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_04', false)
		run Sub_Event273()

local flow Sub_Event410():
	if EventFlowSystemActor.IsMyVillage():
		# It is my sincere hope that we receive enough donations to completely fill out our museum.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_03', false)
		run Sub_Event169()
	else:
		# We are always working to increase the number of exhibits on display, so I hope you'll visit us again soon!
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_04', false)
		run Sub_Event169()

local flow Sub_Event413():
	if EventFlowSystemActor.IsMyVillage():
		# It is my sincere hope that we receive enough donations to completely fill out our museum.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_03', false)
		run Sub_Event191()
	else:
		# We are always working to increase the number of exhibits on display, so I hope you'll visit us again soon!
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_04', false)
		run Sub_Event191()

local flow Sub_grp_Event196():
	if SubflowResults@2[0] == 0:
		# Jolly good! And now to mark your hard work with an aptly named completion stamp! Let's see…
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:010_02', false)
	else:
		# What else… Oh yes! The art exhibit. I am pleased to present you with this artfully composed completion stamp! 
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:010_05', false)
	EventFlowSystemActor.UIStampRallyMuseumFromOwlHandling('cArt')
	if EventFlowSystemActor.IsMyVillage():
		System.EventFlags['cPlayerVisit:OwlStampGotArt'] = true
	else:
		System.EventFlags['cPlayerVisit:OwlStampGotArt'] = true
	# There! It pleases me to report that the Stamp Rally for the art gallery is finished. You've done this owl proud!
	MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:016', false)
	if not EventFlowSystemActor.MuseumRoomDonateRate2(0, 3):
		# As I'm sure you saw, that gallery is currently quite empty.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_01', false)
		run Sub_Event413()
	elif EventFlowSystemActor.MuseumRoomDonateRate2(8, 3):
		# Of course, there is so much more than just art on display in that gallery. Hoot-hoo! It's true! To look at art is to look into the mind of the artist…
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:016_01', false)
		run Sub_Event191()
	else:
		# As I'm sure you saw, that gallery still has quite a ways to go.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_02', false)
		run Sub_Event413()

local flow Sub_grp_Event360():
	if SubflowResults@2[0] == 0:
		# Jolly good! And now to mark your hard work with an aptly named completion stamp! Let's see…
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:010_02', false)
	else:
		# And now, the fossils! For uncovering their ancient mysteries, I grant you this completion stamp. Bravo!
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:010_04', false)
	SubflowResults[0] = 1
	EventFlowSystemActor.UIStampRallyMuseumFromOwlHandling('cFossil')
	if EventFlowSystemActor.IsMyVillage():
		System.EventFlags['cPlayer:OwlStampGotFossil'] = true
	else:
		System.EventFlags['cPlayerVisit:OwlStampGotFossil'] = true
	# Very well done! You've finished the Stamp Rally in the fossil gallery!
	MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:013_01', false)
	if not EventFlowSystemActor.MuseumRoomDonateRate2(0, 2):
		# As I'm sure you saw, that gallery is currently quite empty.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_01', false)
		run Sub_Event410()
	elif EventFlowSystemActor.MuseumRoomDonateRate2(4, 2):
		# As the host of these rallies, it pleases me to my pinfeathers to see you frolic amid the fossils so! The views you get as you stand upon the circles …
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:013_02', false)
		run Sub_Event169()
	else:
		# As I'm sure you saw, that gallery still has quite a ways to go.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_02', false)
		run Sub_Event410()

local flow Sub_grp_Event367():
	if SubflowResults@2[0] == 0:
		# Jolly good! And now to mark your hard work with an aptly named completion stamp! Let's see…
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:010_02', false)
	else:
		# Now to the bugs. For daring to enter their fearsome presence, I give to you another completion stamp!
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:010_03', false)
	SubflowResults[0] = 1
	EventFlowSystemActor.UIStampRallyMuseumFromOwlHandling('cInsect')
	if EventFlowSystemActor.IsMyVillage():
		System.EventFlags['cPlayer:OwlStampGotInsect'] = true
	else:
		System.EventFlags['cPlayerVisit:OwlStampGotInsect'] = true
	# You've finished the Stamp Rally in the bug exhibit! By my beak, what a showing!
	MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:011_01', false)
	if not EventFlowSystemActor.MuseumRoomDonateRate2(0, 1):
		# As I'm sure you saw, that gallery is currently quite empty.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_01', false)
		run Sub_Event407()
	elif EventFlowSystemActor.MuseumRoomDonateRate2(3, 1):
		# Your willingness to explore the bug rooms with such gusto is…admirable. I, myself, find lingering there quite impossible!
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:011_02', false)
		run Sub_Event273()
	else:
		# As I'm sure you saw, that gallery still has quite a ways to go.
		MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_24_Museum_StampRally:020_02', false)
		run Sub_Event407()
