flow WebSetting_Activate():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.CheckFreeCommunication(true)
    if EventFlowSystemActor.IsApprovedFreeCommunication():
        EventFlowSystemActor.MessageLockNext(1)
        # Preparing NookLink access...
        EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_Network:030', false)
        if EventFlowSystemActor.NetMode() not in (0, 2):
            EventFlowSystemActor.NetShutdown('cNetShutdown', false)
        EventFlowSystemActor.NetConnectInit('cConnectInet', true)
        if EventFlowSystemActor.CheckErrorType(2):
            run WebSetting_Activate_Failed()
        else:
            EventFlowSystemActor.NetCheckNSA('cCheckNSA', true)
            if EventFlowSystemActor.CheckErrorType(2):
                run WebSetting_Activate_Failed()
            else:
                EventFlowSystemActor.NetGetPOPID(true)
                if EventFlowSystemActor.CheckErrorType(2):
                    run WebSetting_Activate_Failed()
                else:
                    EventFlowSystemActor.UploadProfile(false, true)
                    if EventFlowSystemActor.CheckErrorType(2):
                        if EventFlowSystemActor.NetIsAppError('cUploadProfile'):
                            EventFlowSystemActor.MessageSuspend()
                            # Your profile could not be sent. If this process fails repeatedly, please retake your profile photo and try again.
                            EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:0820', true)
                        run WebSetting_Activate_Failed()
                    else:
                        EventFlowSystemActor.NetUploadEmoticon(false, -1, false)
                        if EventFlowSystemActor.CheckErrorType(2):
                            run WebSetting_Activate_Failed()
                        else:
                            EventFlowSystemActor.NetUploadCatalog(true, false)
                            if EventFlowSystemActor.CheckErrorType(2):
                                run WebSetting_Activate_Failed()
                            else:
                                EventFlowSystemActor.NetUploadRewardUnlock(false, false)
                                if EventFlowSystemActor.CheckErrorType(2):
                                    run WebSetting_Activate_Failed()
                                else:
                                    EventFlowSystemActor.NetUploadResortUnlock(false, false)
                                    if EventFlowSystemActor.CheckErrorType(2):
                                        run WebSetting_Activate_Failed()
                                    else:
                                        EventFlowSystemActor.NetUploadLifeTips(false, false)
                                        if EventFlowSystemActor.CheckErrorType(2):
                                            run WebSetting_Activate_Failed()
                                        else:
                                            EventFlowSystemActor.NetUploadPlayerMemories(false, false)
                                            if EventFlowSystemActor.CheckErrorType(2):
                                                run WebSetting_Activate_Failed()
                                            else:
                                                run WebSetting_Activate_Core()
    else:
        # To use this service, you'll need someone to turn on Communicating with Others in Parental Controls. For now, let's go back to the title screen so you…
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:151', true)
        run SNPC_rco_92_OtherSettings::Seq_Closerun SNPC_rco_92_OtherSettings::Seq_Close()
 
flow WebSetting_Activate_Core():
    EventFlowSystemActor.NotifyUseNSOAppli('cNotifyUseNSOAppli', true)
    if EventFlowSystemActor.CheckErrorType(2):
        run WebSetting_Activate_Failed()
    else:
        EventFlowSystemActor.MessageSuspend()
        run WebSetting_Activate_Success()
 
flow WebSetting_Activate_Failed():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.MessageUnlockNext()
    # I'm terribly sorry, but it seems the process failed. Do you want to give it another try?
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:150', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run WebSetting_Activate()
    else:
        run SNPC_rco_92_OtherSettings::Sel_EndMenurun SNPC_rco_92_OtherSettings::Sel_EndMenu()
 
flow WebSetting_Activate_Success():
    System.EventFlags['cPlayer:Activate_WebService'] = true
    EventFlowSystemActor.MessageSuspend()
    # Saving. Do not touch .
    EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_Save:001', false)
    EventFlowSystemActor.SaveSimpleSave('cAll')
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.MessageUnlockNext()
    # Yes, yes, setup is complete. Please try accessing it under the Game-Specific Services section of the Nintendo Switch Online app.
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:100', false)
    # I hope you continue to enjoy life on ISLAND.
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:120', false)
    run SNPC_rco_92_OtherSettings::Seq_Closerun SNPC_rco_92_OtherSettings::Seq_Close()
 
flow WebSetting_DataUpload():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.CheckFreeCommunication(true)
    if EventFlowSystemActor.IsApprovedFreeCommunication():
        EventFlowSystemActor.MessageLockNext(1)
        # Sending play data...
        EventFlowSystemActor.OpenMessageWindow('TalkSys/SYS_Network:031', false)
        if EventFlowSystemActor.NetMode() not in (0, 2):
            EventFlowSystemActor.NetShutdown('cNetShutdown', false)
        EventFlowSystemActor.NetConnectInit('cConnectInet', true)
        if EventFlowSystemActor.CheckErrorType(2):
            run WebSetting_Upload_Failed()
        else:
            EventFlowSystemActor.NetCheckNSA('cCheckNSA', true)
            if EventFlowSystemActor.CheckErrorType(2):
                run WebSetting_Upload_Failed()
            else:
                EventFlowSystemActor.NetGetPOPID(true)
                if EventFlowSystemActor.CheckErrorType(2):
                    run WebSetting_Upload_Failed()
                else:
                    EventFlowSystemActor.UploadProfile(false, true)
                    if EventFlowSystemActor.CheckErrorType(2):
                        if EventFlowSystemActor.NetIsAppError('cUploadProfile'):
                            EventFlowSystemActor.MessageSuspend()
                            # Your profile could not be sent. If this process fails repeatedly, please retake your profile photo and try again.
                            EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:0820', true)
                        run WebSetting_Upload_Failed()
                    else:
                        EventFlowSystemActor.NetUploadEmoticon(false, -1, false)
                        if EventFlowSystemActor.CheckErrorType(2):
                            run WebSetting_Upload_Failed()
                        else:
                            EventFlowSystemActor.NetUploadCatalog(true, false)
                            if EventFlowSystemActor.CheckErrorType(2):
                                run WebSetting_Upload_Failed()
                            else:
                                EventFlowSystemActor.NetUploadRewardUnlock(false, false)
                                if EventFlowSystemActor.CheckErrorType(2):
                                    run WebSetting_Upload_Failed()
                                else:
                                    EventFlowSystemActor.NetUploadResortUnlock(true, false)
                                    if EventFlowSystemActor.CheckErrorType(2):
                                        run WebSetting_Upload_Failed()
                                    else:
                                        EventFlowSystemActor.NetUploadLifeTips(true, false)
                                        if EventFlowSystemActor.CheckErrorType(2):
                                            run WebSetting_Upload_Failed()
                                        else:
                                            EventFlowSystemActor.NetUploadPlayerMemories(false, false)
                                            if EventFlowSystemActor.CheckErrorType(2):
                                                run WebSetting_Upload_Failed()
                                            else:
                                                run WebSetting_Upload_Success()
    else:
        # To use this service, you'll need someone to turn on Communicating with Others in Parental Controls. For now, let's go back to the title screen so you…
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:151', true)
        run SNPC_rco_92_OtherSettings::Seq_Closerun SNPC_rco_92_OtherSettings::Seq_Close()
 
flow WebSetting_Explain():
    # NookLink is a game-specific service developed by Nook Inc. for the Nintendo Switch Online app. Say you have some custom design QR codes made in Anima…
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:200', false)
    if System.EventFlags['cPlayer:Activate_WebService']:
        # That sums up everything. Do you need to hear it again?
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:021', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run WebSetting_Explain()
        else:
            run SNPC_rco_92_OtherSettings::Sel_EndMenurun SNPC_rco_92_OtherSettings::Sel_EndMenu()
    else:
        # That sums up everything. Are you ready to connect to the internet and get set up with NookLink access?
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:020', false)
        switch EventFlowSystemActor.GeneralTalkChoice3():
            case 0:
                run WebSetting_Activate()
            case 1:
                run WebSetting_Explain()
            case 2:
                run SNPC_rco_92_OtherSettings::Sel_EndMenurun SNPC_rco_92_OtherSettings::Sel_EndMenu()
 
flow WebSetting_Main():
    # NookLink settings? Of course! Of course!
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:001', false)
    if System.EventFlags['cPlayer:Activate_WebService']:
        # I believe you are already able to access NookLink, so how can I help you, PLAYER?
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:016', false)
        switch EventFlowSystemActor.GeneralTalkChoice3():
            case 0:
                run WebSetting_Explain()
            case 1:
                run WebSetting_UploadConfirm()
            case 2:
                run SNPC_rco_92_OtherSettings::Sel_EndMenurun SNPC_rco_92_OtherSettings::Sel_EndMenu()
    else:
        # Then are you ready to connect to the internet and get set up with NookLink access?
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:010', false)
        switch EventFlowSystemActor.GeneralTalkChoice3():
            case 0:
                run WebSetting_Activate()
            case 1:
                run WebSetting_Explain()
            case 2:
                run SNPC_rco_92_OtherSettings::Sel_EndMenurun SNPC_rco_92_OtherSettings::Sel_EndMenu()
 
flow WebSetting_UploadConfirm():
    # Yes, yes, I can help you connect to the internet to upload the play data and profile used in NookLink. Are you ready to connect to the internet now?
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:160', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run WebSetting_DataUpload()
    else:
        run SNPC_rco_92_OtherSettings::Sel_EndMenurun SNPC_rco_92_OtherSettings::Sel_EndMenu()
 
flow WebSetting_Upload_Failed():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.MessageUnlockNext()
    # I'm terribly sorry, but it seems the process failed. Do you want to give it another try?
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:150', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run WebSetting_DataUpload()
    else:
        run SNPC_rco_92_OtherSettings::Sel_EndMenurun SNPC_rco_92_OtherSettings::Sel_EndMenu()
 
flow WebSetting_Upload_Success():
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.MessageUnlockNext()
    # Your play data has been uploaded! Don't forget to open up NookLink with the Nintendo Switch Online app when you have a moment.
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:161', false)
    # I hope you continue to enjoy life on ISLAND.
    MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_93_BlancoSettings:120', false)
    run SNPC_rco_92_OtherSettings::Seq_Closerun SNPC_rco_92_OtherSettings::Seq_Close()
 
